(()=>{"use strict";var e={698:(e,t,n)=>{n.d(t,{Z:()=>i});var a=n(537),r=n.n(a),s=n(645),l=n.n(s)()(r());l.push([e.id,"// extracted by mini-css-extract-plugin\nexport {};","",{version:3,sources:["webpack://./src/js/Components/Board/main/view/board-style.css"],names:[],mappings:"AAAA;QACQ,CAAA",sourcesContent:["// extracted by mini-css-extract-plugin\nexport {};"],sourceRoot:""}]);const i=l},960:(e,t,n)=>{n.d(t,{Z:()=>i});var a=n(537),r=n.n(a),s=n(645),l=n.n(s)()(r());l.push([e.id,"// extracted by mini-css-extract-plugin\nexport {};","",{version:3,sources:["webpack://./src/js/Components/Dialogs/GameOverDialog/game-over-dialog-styles.css"],names:[],mappings:"AAAA;QACQ,CAAA",sourcesContent:["// extracted by mini-css-extract-plugin\nexport {};"],sourceRoot:""}]);const i=l},61:(e,t,n)=>{n.d(t,{Z:()=>i});var a=n(537),r=n.n(a),s=n(645),l=n.n(s)()(r());l.push([e.id,"// extracted by mini-css-extract-plugin\nexport {};","",{version:3,sources:["webpack://./src/js/Components/Dialogs/SettingsDialog/view/settings-styles.css"],names:[],mappings:"AAAA;QACQ,CAAA",sourcesContent:["// extracted by mini-css-extract-plugin\nexport {};"],sourceRoot:""}]);const i=l},226:(e,t,n)=>{n.d(t,{Z:()=>i});var a=n(537),r=n.n(a),s=n(645),l=n.n(s)()(r());l.push([e.id,"// extracted by mini-css-extract-plugin\nexport {};","",{version:3,sources:["webpack://./src/js/Components/Fleet/main/view/fleet-style.css"],names:[],mappings:"AAAA;QACQ,CAAA",sourcesContent:["// extracted by mini-css-extract-plugin\nexport {};"],sourceRoot:""}]);const i=l},440:(e,t,n)=>{n.d(t,{Z:()=>i});var a=n(537),r=n.n(a),s=n(645),l=n.n(s)()(r());l.push([e.id,"// extracted by mini-css-extract-plugin\nexport {};","",{version:3,sources:["webpack://./src/js/Components/Game/utility/ai-vs-ai-styles.css"],names:[],mappings:"AAAA;QACQ,CAAA",sourcesContent:["// extracted by mini-css-extract-plugin\nexport {};"],sourceRoot:""}]);const i=l},614:(e,t,n)=>{n.d(t,{Z:()=>i});var a=n(537),r=n.n(a),s=n(645),l=n.n(s)()(r());l.push([e.id,"// extracted by mini-css-extract-plugin\nexport {};","",{version:3,sources:["webpack://./src/js/Components/Grids/MainGrid/main/view/main-grid-styles.css"],names:[],mappings:"AAAA;QACQ,CAAA",sourcesContent:["// extracted by mini-css-extract-plugin\nexport {};"],sourceRoot:""}]);const i=l},346:(e,t,n)=>{n.d(t,{Z:()=>i});var a=n(537),r=n.n(a),s=n(645),l=n.n(s)()(r());l.push([e.id,"// extracted by mini-css-extract-plugin\nexport {};","",{version:3,sources:["webpack://./src/js/Components/Grids/TrackingGrid/main/view/tracking-grid-styles.css"],names:[],mappings:"AAAA;QACQ,CAAA",sourcesContent:["// extracted by mini-css-extract-plugin\nexport {};"],sourceRoot:""}]);const i=l},320:(e,t,n)=>{n.d(t,{Z:()=>i});var a=n(537),r=n.n(a),s=n(645),l=n.n(s)()(r());l.push([e.id,"// extracted by mini-css-extract-plugin\nexport {};","",{version:3,sources:["webpack://./src/js/Components/Ship/main/view/ship-styles.css"],names:[],mappings:"AAAA;QACQ,CAAA",sourcesContent:["// extracted by mini-css-extract-plugin\nexport {};"],sourceRoot:""}]);const i=l},804:(e,t,n)=>{n.d(t,{Z:()=>i});var a=n(537),r=n.n(a),s=n(645),l=n.n(s)()(r());l.push([e.id,"// extracted by mini-css-extract-plugin\nexport {};","",{version:3,sources:["webpack://./src/styles/normalize.css"],names:[],mappings:"AAAA;QACQ,CAAA",sourcesContent:["// extracted by mini-css-extract-plugin\nexport {};"],sourceRoot:""}]);const i=l},719:(e,t,n)=>{n.d(t,{Z:()=>i});var a=n(537),r=n.n(a),s=n(645),l=n.n(s)()(r());l.push([e.id,"// extracted by mini-css-extract-plugin\nexport {};","",{version:3,sources:["webpack://./src/styles/page-style.css"],names:[],mappings:"AAAA;QACQ,CAAA",sourcesContent:["// extracted by mini-css-extract-plugin\nexport {};"],sourceRoot:""}]);const i=l},493:(e,t,n)=>{n.d(t,{Z:()=>i});var a=n(537),r=n.n(a),s=n(645),l=n.n(s)()(r());l.push([e.id,"// extracted by mini-css-extract-plugin\nexport {};","",{version:3,sources:["webpack://./src/styles/style.css"],names:[],mappings:"AAAA;QACQ,CAAA",sourcesContent:["// extracted by mini-css-extract-plugin\nexport {};"],sourceRoot:""}]);const i=l},645:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",a=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),a&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),a&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,a,r,s){"string"==typeof e&&(e=[[null,e,void 0]]);var l={};if(a)for(var i=0;i<this.length;i++){var o=this[i][0];null!=o&&(l[o]=!0)}for(var c=0;c<e.length;c++){var d=[].concat(e[c]);a&&l[d[0]]||(void 0!==s&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=s),n&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=n):d[2]=n),r&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=r):d[4]="".concat(r)),t.push(d))}},t}},537:e=>{e.exports=function(e){var t=e[1],n=e[3];if(!n)return t;if("function"==typeof btoa){var a=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),r="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a),s="/*# ".concat(r," */");return[t].concat([s]).join("\n")}return[t].join("\n")}},379:e=>{var t=[];function n(e){for(var n=-1,a=0;a<t.length;a++)if(t[a].identifier===e){n=a;break}return n}function a(e,a){for(var s={},l=[],i=0;i<e.length;i++){var o=e[i],c=a.base?o[0]+a.base:o[0],d=s[c]||0,u="".concat(c," ").concat(d);s[c]=d+1;var p=n(u),g={css:o[1],media:o[2],sourceMap:o[3],supports:o[4],layer:o[5]};if(-1!==p)t[p].references++,t[p].updater(g);else{var m=r(g,a);a.byIndex=i,t.splice(i,0,{identifier:u,updater:m,references:1})}l.push(u)}return l}function r(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,r){var s=a(e=e||[],r=r||{});return function(e){e=e||[];for(var l=0;l<s.length;l++){var i=n(s[l]);t[i].references--}for(var o=a(e,r),c=0;c<s.length;c++){var d=n(s[c]);0===t[d].references&&(t[d].updater(),t.splice(d,1))}s=o}}},569:e=>{var t={};e.exports=function(e,n){var a=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(n)}},216:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},565:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},795:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var a="";n.supports&&(a+="@supports (".concat(n.supports,") {")),n.media&&(a+="@media ".concat(n.media," {"));var r=void 0!==n.layer;r&&(a+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),a+=n.css,r&&(a+="}"),n.media&&(a+="}"),n.supports&&(a+="}");var s=n.sourceMap;s&&"undefined"!=typeof btoa&&(a+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),t.styleTagTransform(a,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},589:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}}},t={};function n(a){var r=t[a];if(void 0!==r)return r.exports;var s=t[a]={id:a,exports:{}};return e[a](s,s.exports,n),s.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.nc=void 0,(()=>{var e=n(379),t=n.n(e),a=n(795),r=n.n(a),s=n(569),l=n.n(s),i=n(565),o=n.n(i),c=n(216),d=n.n(c),u=n(589),p=n.n(u),g=n(804),m={};m.styleTagTransform=p(),m.setAttributes=o(),m.insert=l().bind(null,"head"),m.domAPI=r(),m.insertStyleElement=d(),t()(g.Z,m),g.Z&&g.Z.locals&&g.Z.locals;var h=n(493),S={};S.styleTagTransform=p(),S.setAttributes=o(),S.insert=l().bind(null,"head"),S.domAPI=r(),S.insertStyleElement=d(),t()(h.Z,S),h.Z&&h.Z.locals&&h.Z.locals;var E=n(719),T={};T.styleTagTransform=p(),T.setAttributes=o(),T.insert=l().bind(null,"head"),T.domAPI=r(),T.insertStyleElement=d(),t()(E.Z,T),E.Z&&E.Z.locals&&E.Z.locals;const A="onEnter",b="onExit",f="playerOne",y="playerTwo",C="human",v="ai",L=[{name:"Carrier",length:5},{name:"Battleship",length:4},{name:"Destroyer",length:3},{name:"Submarine",length:3},{name:"Patrol Boat",length:2}],I="startState",P="placementState",R="progressState",k="overState",M="miss",O="hit",w="ship_sunk",x="unexplored",N="occupied",H="empty",D={UP:[-1,0],RIGHT:[0,1],DOWN:[1,0],LEFT:[0,-1]},_={VERTICAL:"vertical",HORIZONTAL:"horizontal"},B="HvH",U=["Seaman Bumbling BitBarnacle","Captain CodeSmells","Fleet Admiral ByteBeard"],$=e=>String.fromCharCode(65+e),G=e=>e.charCodeAt()-65,F=e=>e.every((e=>Array.isArray(e)&&q(e))),q=e=>Array.isArray(e)&&2===e.length&&e.every((e=>"number"==typeof e)),Y=e=>{if(Array.isArray(e[0])){if(!F(e))throw new Error(`Invalid Coordinates In ${JSON.stringify(e)}. Expected format: [[number, number]]`)}else if(!q(e))throw new Error(`Invalid Coordinate Pair: ${JSON.stringify(e)}. Expected format: [number, number]`)},W=e=>{const t=e.match(/([A-Za-z]+)/)[0]?.toUpperCase(),n=+e.match(/\d+/)[0];if(!t||isNaN(n))throw new Error("Invalid coordinate format.");return[isNaN(e[0])?G(t):n,isNaN(e[0])?n:G(t)]},z=(e,t,n)=>{const a="row"===n,r=$(a?e:t),s=a?t:e;return a?`${r}${s}`:`${s}${r}`},Z=(e,t)=>e[0]===t[0]&&e[1]===t[1],V=e=>e?.toLowerCase().trim(),j=(e,t)=>{const n=((e,t)=>{const n=J(e,t,!0);return[Math.abs(n[0]),Math.abs(n[1])]})(e,t);return 1===n[0]&&1===n[1]},X=e=>{const t=[Math.abs(e[0]),Math.abs(e[1])];return 1===t[0]&&0===t[1]||0===t[0]&&1===t[1]},K=(e,t)=>{if(F([e,t]))return[e[0]+t[0],e[1]+t[1]]},Q=e=>{const t=V(e);if(t!==_.VERTICAL&&t!==_.HORIZONTAL)throw new Error(`Invalid Orientation: ${t}`);return t===_.VERTICAL?{up:D.UP,down:D.DOWN}:{left:D.LEFT,right:D.RIGHT}},J=(e,t,n=!1)=>{if(!F([e,t]))return;const a=e=>0===e?0:e/Math.abs(e),r=t[0]-e[0],s=t[1]-e[1];return n?[a(r),a(s)]:[r,s]},ee=(e,t)=>{const n=V(t);if(n===_.VERTICAL){const{left:t,right:n}=Q(_.HORIZONTAL);return[K(e,t),K(e,n)]}if(n===_.HORIZONTAL){const{up:t,down:n}=Q(_.VERTICAL);return[K(e,t),K(e,n)]}throw new Error(`Invalid orientation: ${t}`)},te=(e,t)=>{if(!F([e,t]))return;const n=J(e,t,!1);return X(n)},ne=e=>e?.splice(Math.floor(Math.random()*e.length),1)[0]??null;function ae({type:e,attributes:t={},text:n=null,children:a=[],nameSpace:r=null,listeners:s={},ns:l=null}={}){try{"svg"!==e&&"path"!==e||r||(r="http://www.w3.org/2000/svg");const l=null===r?document.createElement(e):document.createElementNS(r,e);for(const[e,n]of Object.entries(t))l.setAttribute(e,n);n&&(l.textContent=n);for(const[e,t]of Object.entries(s))Array.isArray(t)?t.forEach((t=>{"function"==typeof t&&l.addEventListener(e,t)})):"function"==typeof t&&l.addEventListener(e,t);return a&&a.length>0&&a.forEach((e=>{l.appendChild(ae(e))})),l}catch(t){console.error(`Failed to build element: ${e}`,t)}}const re="dialog",se="button",le="input",ie="div",oe="span",ce="p",de=se,ue=(e,{attributes:t={},text:n="",children:a=[],namespace:r=null}={})=>({type:e,attributes:t,text:n,children:a,namespace:r}),pe=e=>ae(e),ge=(e,{text:t="",attributes:n={},children:a=[],namespace:r=null}={})=>ae(ue(e,{text:t,attributes:n,children:a,namespace:r})),me=(e,t=[],n)=>ue(ie,{attributes:{class:e},children:t,...n}),he=(e,t)=>ue(ce,{text:e,attributes:{class:t}}),Se=(e,t)=>ue(de,{text:e,attributes:{class:t}}),Ee=(e,t)=>ue(oe,{text:e,attributes:{class:t}}),Te=e=>`data-${e}`,Ae="true",be="false",fe="ship-element",ye="ship-name",Ce={SHIP_NAME:Te("name"),SHIP_SUNK:Te("sunk"),SHIP_LENGTH:Te("length"),SHIP_ORIENTATION:Te("orientation"),SHIP_PLACED:Te("placed")},ve="main-fleet-ship-list",Le="main-fleet-header",Ie="Your Fleet",Pe="tracking-fleet",Re="tracking-fleet-ship-list",ke="tracking-fleet-header",Me="Enemy Fleet",Oe="change",we="click",xe="mouseover",Ne="keydown",He="KeyR",De="Space",_e="Escape",Be=({elementType:e,attribute:t,value:n})=>`${e}[${t}='${n}']`,Ue={CLASSES:{WRAPPER:"grid-wrapper",HEADER:"grid-header",CELL:"grid-cell",ROW:"board-row",LABELS:{ROW:"board-row-label",COL_CONTAINER:"board-col-labels",COL:"board-col-label"}},LABEL_TYPES:{LETTER:"letter",NUMERIC:"numeric"},get CELL_SELECTOR(){return`.${Ue.CLASSES.CELL}`}},$e={CLASSES:{TYPE:"tracking-grid",HEADER:"tracking-grid-header",WRAPPER:"tracking-grid-wrapper"},PROPERTIES:{CELL_ELEMENT:se,HEADER_TEXT:"Enemy Territory",ATTRIBUTES:{CELL_STATUS_DATA:Te("cell-status"),CELL_STATUS_ACCESSOR:"cellStatus"}},SELECTORS:{CELL:e=>Be({elementType:$e.PROPERTIES.CELL_ELEMENT,attribute:"value",value:e})}},Ge=({headerClass:e,headerText:t})=>ue(ie,{attributes:{class:e},children:[ue(ce,{text:t})]}),Fe=e=>"col"===e?{row:Ue.LABEL_TYPES.NUMERIC,col:Ue.LABEL_TYPES.LETTER}:{row:Ue.LABEL_TYPES.LETTER,col:Ue.LABEL_TYPES.NUMERIC},qe=({count:e,type:t,axisLabelClass:n})=>Array.from({length:e}).map(((e,a)=>ue(ce,{text:t===Ue.LABEL_TYPES.LETTER?$(a):`${a}`,attributes:{class:n}}))),Ye=({labels:e})=>ue(ie,{attributes:{class:Ue.CLASSES.LABELS.COL_CONTAINER},children:e}),We=({elementType:e,attributes:t})=>ue(e,{attributes:{class:Ue.CLASSES.CELL,...t}}),ze=({rowLabelObj:e,cellObjs:t})=>ue(ie,{attributes:{class:Ue.CLASSES.ROW},children:[e,...t]});var Ze=n(346),Ve={};Ve.styleTagTransform=p(),Ve.setAttributes=o(),Ve.insert=l().bind(null,"head"),Ve.domAPI=r(),Ve.insertStyleElement=d(),t()(Ze.Z,Ve),Ze.Z&&Ze.Z.locals&&Ze.Z.locals;const je=({numberOfRows:e,numberOfCols:t,letterAxis:n})=>{const a={},r=()=>{const{wrappedTrackingGridElement:r}=(({numberOfRows:e,numberOfCols:t,letterAxis:n})=>{const a=Ge({headerClass:`${$e.CLASSES.HEADER} ${Ue.CLASSES.HEADER}`,headerText:$e.PROPERTIES.HEADER_TEXT}),r=Fe(n),s=qe({count:t,type:r.col,axisLabelClass:Ue.CLASSES.LABELS.COL}),l=qe({count:e,type:r.row,axisLabelClass:Ue.CLASSES.LABELS.ROW}).map((e=>ze({rowLabelObj:e,cellObjs:s.map((t=>{return n=`${e.text}${t.text}`,We({elementType:$e.PROPERTIES.CELL_ELEMENT,attributes:{value:`${n}`,[$e.PROPERTIES.ATTRIBUTES.CELL_STATUS_DATA]:x}});var n}))}))),i=ue(ie,{attributes:{class:`${$e.CLASSES.WRAPPER} ${Ue.CLASSES.WRAPPER}`},children:[ue(ie,{attributes:{class:$e.CLASSES.TYPE},children:[a,Ye({labels:s}),...l]})]});return{wrappedTrackingGridElement:pe(i)}})({numberOfRows:e,numberOfCols:t,letterAxis:n}),s=r.querySelector(`.${$e.CLASSES.TYPE}`),l=s.querySelectorAll(`.${Ue.CLASSES.CELL}`);Object.assign(a,{wrappedTrackingGridElement:r,grid:s,cells:l})};return r(),{attachTo:e=>e.append(a.wrappedTrackingGridElement),attachWithinWrapper:e=>a.wrappedTrackingGridElement.append(e),getCell:e=>a.grid.querySelector($e.SELECTORS.CELL(e)),setCellStatus:(e,t)=>e.setAttribute($e.PROPERTIES.ATTRIBUTES.CELL_STATUS_DATA,t),hide:()=>a.wrappedTrackingGridElement.style.display="none",show:()=>a.wrappedTrackingGridElement.removeAttribute("style"),enable:()=>[...a.cells].forEach((e=>{(e=>e.dataset[$e.PROPERTIES.ATTRIBUTES.CELL_STATUS_ACCESSOR]===x)(e)&&(e.disabled=!1)})),disable:()=>[...a.cells].forEach((e=>e.disabled=!0)),elements:{getWrapper:()=>a.wrappedTrackingGridElement,getGrid:()=>a.grid},reset:()=>{r()}}},Xe="ai-display-tracking-grid",Ke="ai-display-header",Qe=e=>`${e}`,Je=(e,t,n)=>{const a=((e,t)=>{const n=je(e),a=n.elements.getGrid();a.classList.add(Xe);const r=a.querySelector(".tracking-grid-header"),s=a.querySelector(".tracking-grid-header > p");return r.classList.add(Ke),s.textContent=Qe(t),a.querySelectorAll("button.grid-cell").forEach((e=>e.setAttribute("disabled",!0))),n})(e,t);a.displayResult=(e,t)=>{const n=a.getCell(e);a.setCellStatus(n,t)};const r=(e=>{const t=(()=>{const e=ue(ie,{attributes:{class:Pe}}),t=ue(ce,{text:Me,attributes:{class:ke}}),n=ue(ie,{attributes:{class:Re}});e.children=[t,n];const a=pe(e),r=a.querySelector(`.${Re}`),s=new Map;return{getTrackingFleet:()=>a,addShipView:(e,t)=>s.set(e,t),setShipSunk:e=>s.get(e).setSunk(),populateFleetShipLists:()=>s.forEach((e=>{r.append(e.getShipElement())}))}})();return e.forEach((e=>{const n=(e=>{const t=e.toLowerCase().replace(/ /g,"-"),n=((e,t,n)=>ue(n,{attributes:{class:`${t} ${fe}`,[Ce.SHIP_NAME]:t,[Ce.SHIP_SUNK]:"false"},children:[ue(ce,{text:e,attributes:{class:ye}})]}))(e,t,ie),a=pe(n);return{getShipElement:()=>a,setSunk:()=>a.setAttribute(Ce.SHIP_SUNK,Ae)}})(e),a=e.toLowerCase().replace(" ","-");t.addShipView(a,n)})),t.populateFleetShipLists(),t})(n);return{trackingGrid:a,fleet:r}};function et(){let e=null,t=null,n=0;return{enqueue:a=>{const r=(({data:e,next:t=null})=>{const n=e;let a=t;return{get data(){return n},get next(){return a},set next(e){a=e}}})({data:a});0===n?(e=r,t=r):(t.next=r,t=r),n++},dequeue:()=>{if(0===n)return;const a=e.data;return e=e.next,1===n&&(t=null),n--,a},peekHead:()=>e?.data.slice()??null,peekTail:()=>t?.data.slice()??null,isEmpty:()=>0===n,size:()=>n,copyToArray:()=>{if(!e)return[];let t=e;const n=[];for(;null!==t;)n.push(t.data.slice()),t=t.next;return n}}}const tt=(e,t,n=null)=>Array.from({length:e},(()=>Array.from({length:t},(()=>({status:n}))))),nt=(e,t)=>{const n=[e.length,e[0].length];return t[0]>=0&&t[0]<n[0]&&t[1]>=0&&t[1]<n[1]},at=e=>e.map((e=>[...e])),rt=(e,t)=>0===t[0]||0===t[1]||t[0]===e.length-1||t[1]===e[0].length-1,st=(e,t)=>{if(nt(e,t))return e[t[0]][t[1]]},lt=(e,t)=>{const n=st(e,t);if(n)return n.status},it=(e,t,n)=>{let a=n;"string"==typeof a&&(a=D[a.toUpperCase()]);const r=K(a,t);return nt(e,r)?r:void 0},ot=(e,t)=>{const n=[];for(const a of Object.keys(D)){const r=it(e,t,a);r&&n.push(r)}return n},ct=(e,t)=>ot(e,t).filter((t=>lt(e,t)===x)),dt=({grid:e,start:t,direction:n,type:a})=>{const r=[];let s=K(t,n);for(;lt(e,s)===a;)r.push(s),s=K(s,n);return r},ut=({trackingGrid:e,popRandomMove:t,popMove:n})=>{let a=null;const r=et(),s=[],l=()=>{for(;s.length>0;){const e=n(ne(s));if(e)return e}return null},i=()=>{if(!a)return 0===s.length?t():l();if(a){const t=ct(e,a);return t.length>0?n(ne(t)):(()=>{a=null,s.length=0;const t=[];for(;!r.isEmpty();)t.push(r.dequeue());return s.push(...t.flatMap((t=>ct(e,t)))),l()||i()})()}};return{getNextMove:i,processMoveResult:(e,t)=>{t===M||(t===O?(r.enqueue(e),a=e):t===w&&(()=>{for(a=null,s.length=0;!r.isEmpty();)r.dequeue()})())},getLastHit:()=>a,setLastHit:e=>{r.enqueue(e),a=e},reset:()=>{for(a=null,s.length=0;!r.isEmpty();)r.dequeue()},hasPriorityMoves:()=>0!==s.length,hasHitsInChain:()=>!r.isEmpty()}},pt=({data:e,next:t=null,prev:n=null})=>{const a=e;let r=t,s=n;return{get data(){return a},get next(){return r},set next(e){r=e},get prev(){return s},set prev(e){s=e}}};function gt(){let e=null,t=null,n=0;return{pushFront:a=>{const r=pt({data:a});0===n?(e=r,t=r):(r.next=e,e.prev=r,e=r),n++},pushBack:a=>{const r=pt({data:a});0===n?(e=r,t=r):(r.prev=t,t.next=r,t=r),n++},popFront:()=>{if(0===n)return;const a=e.data;return e=e.next,1===n?t=null:e.prev=null,n--,a},popBack:()=>{if(0===n)return;const a=t.data;return t=t.prev,1===n?e=null:t.next=null,n--,a},peekHead:()=>e?.data.slice()??null,peekTail:()=>t?.data.slice()??null,peekBeforeTail:()=>t?.prev?.data.slice()??null,isEmpty:()=>0===n,size:()=>n,copyToArray:()=>{if(!e)return[];let t=e;const n=[];for(;null!==t;)n.push(t.data.slice()),t=t.next;return n}}}function mt({coordinates:e=null,startingOrientation:t=null}={}){let n=gt(),a=t,r=null,s=null,l=null;const i=e=>te(e,n.peekTail()),o=(e,t=a)=>((e,t,n)=>{if(!F([t,n]))return;const a=V(e);return a===_.VERTICAL?((e,t)=>!j(e,t)&&e[1]===t[1])(t,n):a===_.HORIZONTAL?((e,t)=>!j(e,t)&&e[0]===t[0])(t,n):null})(t,e,n.peekTail())&&(i(e)||(e=>te(e,n.peekHead()))(e)),c=({coordinates:e=null,initialDirection:t=null})=>{l=t??J(n.peekHead(),e),s=l,r=[-l[0],-l[1]]},d=e=>{try{Y(e)}catch(e){return console.error(e),!1}return n.isEmpty()?(e=>(n.pushFront(e),1===n.size()))(e):1===n.size()?(e=>{const t=((e,t,n=!0)=>{if(!F([e,t]))return;const a=J(e,t,!0!==n);return X(a)?e[0]===t[0]?_.HORIZONTAL:_.VERTICAL:null})(n.peekHead(),e);return!!o(e,t)&&(c({coordinates:e}),a=t,n.pushBack(e),!0)})(e):o(e)?(e=>(i(e)?(l=J(n.peekTail(),e),n.pushBack(e)):(l=J(n.peekHead(),e),n.pushFront(e)),!0))(e):void 0};if(e&&d(e),t){const e=Q(t),n=Object.values(e),a=n[Math.floor(n.length*Math.random())];c({initialDirection:a})}return{addCoordinates:d,size:()=>n.size(),peekHead:()=>n.peekHead(),peekTail:()=>n.peekTail(),getOrientation:()=>a,isEmpty:()=>n.isEmpty(),getCurrentDirection:()=>l,getAfterHeadDirection:()=>r,getAfterTailDirection:()=>s,popTail:()=>n.popBack(),popHead:()=>n.popFront(),copyChainToArray:()=>n.copyToArray(),reset:()=>{n=gt(),a=null,l=null},isInitialized:()=>n.size()>0&&null!==a&&null!==l&&null!==r&&null!==s}}const ht=({initialGrid:e,gridHelpers:t,getOrientationDirections:n,isHitResolved:a,getSmallestShipLength:r,validateFn:s})=>{const l=e.map((e=>e.map((()=>0))));let i=r();const{getCellStatusAt:o,getCellInADirection:c,getCellsInAllDirections:d,getOpenMovesAround:u}=t,p=e=>{if(!s(e))return-1;let t=.25;return t+=(({getCellStatusAt:e,getCellInADirection:t,getOrientationDirections:n,isHitResolved:a,start:r,smallestShipLength:s})=>{if(e(r)!==x)return!1;let l=0;const i=Object.values(_);for(const o of i){let i=!1;const c=Object.values(n(o));for(const n of c){let l=1,o=t(r,n);for(;o&&e(o)!==M&&(e(o)!==O||!a(o));){if(l+=1,l>=s){i=!0;break}o=t(o,n)}}i&&(l+=1)}return l/2})({getCellStatusAt:o,getCellInADirection:c,getOrientationDirections:n,isHitResolved:a,start:e,smallestShipLength:i}),t+=((e,{getCellsInAllDirections:t,getCellStatusAt:n,isHitResolved:a})=>{let r=0;const s=t(e);return r=.33*(4-s.length),s.forEach((t=>{const s=n(t);s===M?r-=.2:s!==O||a(t)?r+=.33:r+=(t=>{let r=0;const s=J(e,t);let l=t,i=n(l);for(;i&&i===O&&!a(l);)r+=2,l=K(l,s),i=n(l);return r})(t)})),r/4})(e,{getCellsInAllDirections:d,getCellStatusAt:o,isHitResolved:a}),t=(e=>Math.round(100*e)/100)(t),t};return{getCellWithHighestProbability:()=>{let e=-1/0;const t=[];return l.forEach(((n,a)=>{n.forEach(((n,r)=>{const s=[a,r];-1!==n&&n>e?(e=n,t.length=0,t.push(s)):n===e&&t.push(s)}))})),t.length>1?t[Math.floor(Math.random()*t.length)]:t.length>0?t[0]:null},calculateProbabilityScore:p,getHighestProbabilityFromMoves:e=>e.map((e=>({move:e,score:p(e)}))).filter((e=>e.score>=0)).sort(((e,t)=>t.score-e.score))[0].move,getHitWithHighestSurroundingProbability:e=>{const t=[];return e.forEach((e=>{const n=u(e).reduce(((e,t)=>e+p(t)),0);t.push({cell:e,score:n})})),t.sort(((e,t)=>t.score-e.score)),t[0].cell},updateState:(e,t=!1)=>{t&&(i=r()),(e=>{e.forEach(((e,t)=>{e.forEach(((e,n)=>{const a=p([t,n]);l[t][n]=a}))}))})(e)}}},St=({trackingGrid:e,fleetData:t})=>{const n=(e=>{const t=new Map(e.map((e=>[e.id,e.length]))),n={id:null,length:null};return{opponentShipSunk:e=>{const a=t.get(e);a&&(n.id=e,n.length=a),t.delete(e)},getLastSunkLength:()=>n.length,getSmallestAliveOpponentShipLength:()=>[...t.values()].reduce(((e,t)=>t<e?t:e),Number.MAX_SAFE_INTEGER),getLiveOpponentShipLengths:()=>[...t.values()],getNumberOfOpponentShipsLeft:()=>t.size,areAllOpponentShipsSunk:()=>0===t.size,reset:()=>{t.clear(),n.id=null,n.length=null}}})(t),a=(()=>{let e=null,t=0,n=0;const a=new Set,r=new Set,s=e=>{try{return Y(e),`${e[0]},${e[1]}`}catch(e){return console.error(`Invalid Hit Coordinates In HitsManager: ${e.message}`),null}},l=e=>[...e].map((e=>e.split(",").map(Number))),i=e=>{let t;"string"==typeof e&&/^\d+,\d+$/.test(e)?t=e:Array.isArray(e)&&(t=s(e)),t&&a.has(t)&&(a.delete(t),r.add(t))};return{resolveHit:i,resolveAllUnresolved:()=>[...a].forEach(i),isHitResolved:e=>r.has(s(e)),addUnresolvedHit:e=>{const t=s(e);!t||a.has(t)||r.has(t)||a.add(t)},setLastHit:t=>e=t,getLastHit:()=>e,addHit:()=>t++,addSunk:e=>n+=e,getHits:()=>t,getSunk:()=>n,areHitsEqualToSunk:()=>t===n,getResolvedHits:()=>l(r),getUnresolvedHits:()=>l(a),hasUnresolvedHits:()=>a.size>0}})(),r=(e=>{const t=t=>(...n)=>t(e,...n),n=(t,n)=>(...a)=>t({grid:e,...a,type:n});return{getCellStatusAt:t(lt),getCellInADirection:t(it),getOpenMovesAround:t(ct),getCellsInAllDirections:t(ot),getOpenMovesInADirection:n(dt,x),getConsecutiveHitsInADirection:n(dt,O),copyGrid:t(at),isAtEdge:t(rt)}})(e,a.isHitResolved),s=e=>e&&r.getCellStatusAt(e)===x&&l(e),l=e=>(({getCellStatusAt:e,getCellInADirection:t,getOrientationDirections:n,isHitResolved:a,start:r,smallestShipLength:s})=>{if(e(r)!==x)return!1;const l=Object.values(_);for(const i of l){let l=1;const o=Object.values(n(i));for(const n of o){let i=t(r,n);for(;i&&e(i)!==M&&(e(i)!==O||!a(i));){if(l+=1,l>=s)return!0;i=t(i,n)}}}return!1})({getCellStatusAt:r.getCellStatusAt,getCellInADirection:r.getCellInADirection,getOrientationDirections:Q,isHitResolved:a.isHitResolved,start:e,smallestShipLength:n.getSmallestAliveOpponentShipLength()}),i=ht({initialGrid:e,canShipFit:l,gridHelpers:r,getOrientationDirections:Q,isHitResolved:a.isHitResolved,getLiveOpponentShipLengths:n.getLiveOpponentShipLengths,getSmallestShipLength:n.getSmallestAliveOpponentShipLength,validateFn:s}),o=(({validateFn:e,sumCoordinates:t,getOpenMovesAround:n,getHighestProbabilityFromMoves:a,hitsManager:r})=>{const s={chain:mt()},l=et(),i=()=>s.chain=mt(),o=()=>s.chain=mt(l.dequeue()),c=e=>{if(!e||0===e.length)return null;const t=s.chain.getOrientation()===_.VERTICAL?_.HORIZONTAL:_.VERTICAL;e.forEach((e=>{r.addUnresolvedHit(e),l.enqueue({coordinates:e,startingOrientation:t})})),o()},d=()=>{const n=t(s.chain.peekTail(),s.chain.getAfterTailDirection());if(e(n))return n;const a=t(s.chain.peekHead(),s.chain.getAfterHeadDirection());return e(a)?a:null};return{getNextInChain:()=>{if(s.chain.isEmpty()){if(l.isEmpty())return null;o()}if(1===s.chain.size()){if(s.chain.isInitialized())return d();const e=(()=>{const e=n(s.chain.peekHead());return e&&e.length>0?a(e):null})();if(e)return e}return d()||c(s.chain.copyChainToArray()),d()},resolvePartOfChain:(e,t)=>{const n=[];if(Z(e,s.chain.peekTail()))for(let e=0;e<t;e++)r.resolveHit(s.chain.popTail());else{if(!Z(e,s.chain.peekHead()))throw new Error(`lastHit: ${e} is not equal to head or tail end of chain.`);for(let e=0;e<t;e++)r.resolveHit(s.chain.popHead())}for(;!s.chain.isEmpty();)n.push(s.chain.popTail());c(n)},getChainSize:()=>s.chain.size(),getChainOrientation:()=>s.chain.getOrientation(),pushToCurrentChain:e=>s.chain.addCoordinates(e),peekTail:()=>s.chain.peekTail(),peekHead:()=>s.chain.peekHead(),getCurrentChainArray:()=>s.chain.copyChainToArray(),resolveCurrentChain:()=>{for(;!s.chain.isEmpty();)r.resolveHit(s.chain.popTail());l.isEmpty()?i():o()},resolveAllChains:()=>{for(i();!l.isEmpty();)l.dequeue()},handleUnresolvedChain:c}})({validateFn:s,sumCoordinates:K,getPerpendicularCoordinates:ee,getOpenMovesAround:r.getOpenMovesAround,getHighestProbabilityFromMoves:i.getHighestProbabilityFromMoves,getHitWithHighestSurroundingProbability:i.getHitWithHighestSurroundingProbability,hitsManager:a});return{fleetManager:n,gridHelpers:r,hitsManager:a,chainManager:o,probabilityMap:i,validateMove:s}},Et=e=>{const{hitsManager:t,chainManager:n,copyGrid:a,updateProbabilityMap:r,opponentShipSunk:s,getLastSunkLength:l,areAllOpponentShipsSunk:i}=e,{setLastHit:o,addHit:c,addUnresolvedHit:d,addSunk:u,areHitsEqualToSunk:p,resolveAllUnresolved:g,resolveHit:m}=t,{resolvePartOfChain:h,getChainSize:S,pushToCurrentChain:E,resolveCurrentChain:T,resolveAllChains:A,handleUnresolvedChain:b}=n;return(({setLastHit:e,addHit:t,pushToCurrentChain:n,addUnresolvedHit:a,addSunk:r,getLastSunkLength:s,areHitsEqualToSunk:l,resolveAllUnresolved:i,updateProbabilityMap:o,copyGrid:c,opponentShipSunk:d,areAllOpponentShipsSunk:u,resolveCurrentChain:p,resolvePartOfChain:g,resolveAllChains:m,getChainSize:h,handleUnresolvedChain:S})=>function(E){const{coordinates:T,result:A}=E;if(A===M)o(c(),!1);else if(A===O||A===w)if(e(T),t(),n(T),a(T),A===w){d(E.id);const e=s(),t=h();if(r(e),l())i(),m();else{if(u())return;t===e?p():t>e?g(T,e):S()}o(c(),!0)}else o(c(),!1)})({setLastHit:o,addHit:c,pushToCurrentChain:E,addUnresolvedHit:d,addSunk:u,getLastSunkLength:l,areHitsEqualToSunk:p,resolveAllUnresolved:g,resolveHit:m,updateProbabilityMap:r,copyGrid:a,opponentShipSunk:s,resolveCurrentChain:T,resolvePartOfChain:h,resolveAllChains:A,getChainSize:S,handleUnresolvedChain:b,areAllOpponentShipsSunk:i})},Tt=({model:e,view:t,letterAxis:n,attackDelay:a})=>{const r=e.properties.id,s=()=>e.fleet.isAllShipsSunk(),l=e.moves.popRandomMove,i=e.moves.popMove,o=e.trackingGrid.get(),c=e.trackingGrid.setCellStatus,d=(e,a)=>{c(e,a);const[r,s]=e,l=z(r,s,n);t.trackingGrid.displayResult(l,a)},u=t=>{switch(+t){case 0:return{getNextMove:l,processResult:({data:e})=>{d(e.coordinates,e.result),p.endTurn()}};case 1:{const{getNextMove:e,processMoveResult:t}=ut({trackingGrid:o,popMove:i,popRandomMove:l});return{getNextMove:e,processResult:({data:e})=>{const{coordinates:n,result:a}=e;d(n,a),t(n,a),p.endTurn()}}}case 2:{const{getNextMove:t,processMoveResult:n}=function({trackingGrid:e,popRandomMove:t,fleetData:n}){const a=St({trackingGrid:e,fleetData:n}),{fleetManager:r,gridHelpers:s,hitsManager:l,chainManager:i,probabilityMap:o,validateMove:c}=a,d=(u=c,(e,t,n)=>{const a=((e,t)=>{const n=e();return n&&n.length>0?Array.isArray(n[0])?t.getHighestProbabilityFromMoves(n):n:t.getCellWithHighestProbability()})(e,t);return a&&u(a)?a:n()});var u;return{getNextMove:()=>d(a.chainManager.getNextInChain,o,t),processMoveResult:Et({hitsManager:l,chainManager:i,copyGrid:s.copyGrid,updateProbabilityMap:o.updateState,opponentShipSunk:r.opponentShipSunk,getLastSunkLength:r.getLastSunkLength,areAllOpponentShipsSunk:r.areAllOpponentShipsSunk})}}({trackingGrid:o,popRandomMove:l,fleetData:e.fleet.getData()});return{getNextMove:t,processResult:({data:e})=>{const{coordinates:t,result:a}=e;d(t,a),n(e),p.endTurn()}}}}},p={attack:()=>{},result:()=>{},lost:()=>{},endTurn:()=>{},reset:()=>{p.attack=()=>{},p.result=()=>{},p.lost=()=>{},p.endTurn=()=>{}}},g={handleShipSunk:e=>{t.fleet.setShipSunk(e),s()&&p.lost({id:r})},processResultFromGrid:t=>{const n=e.fleet.getShip(t.id);n.hit(),n.isSunk()&&g.handleShipSunk(n.id)},handleRequest:({data:t})=>{const n=(t=>e.mainGrid.processIncomingAttack(t))(t),{coordinates:a,cell:r}=n;r.status===O&&g.processResultFromGrid(r),p.result({coordinates:a,result:r.status})}},m={getNextMove:()=>{},processIncomingResult:()=>{},send:e=>()=>setTimeout((()=>p.attack(e)),a),init:e=>{m.getNextMove=e.getNextMove,m.processIncomingResult=e.processResult,e.onShipSunk&&(m.onShipSunk=e.onShipSunk)},sendRequest:()=>{if(s())return;const e=m.getNextMove();setTimeout((()=>p.attack(e)),a)},handleIncomingResultRequest:e=>m.processIncomingResult(e)};return{initializeCombat:t=>{const{sendAttack:n,sendResult:a,sendLost:r,endTurnMethod:s}=t;p.attack=n,p.result=a,p.lost=r,p.endTurn=s,e.moves.initialize(),m.init(u(e.properties.getDifficulty()))},startTurn:()=>m.sendRequest(),getHandlers:()=>({incomingAttackHandler:g.handleRequest,incomingResultHandler:m.handleIncomingResultRequest}),reset:()=>{p.reset(),e.moves.reset()}}},At=({id:e,difficulty:t,attackDelay:n,boardSettings:a,fleetData:r})=>{const s=((e=10,t=10)=>{const n=(e,t)=>Array.from({length:e},(()=>Array.from({length:t},(()=>({status:H})))));let a=n(e,t);const r=(n,a)=>n>=0&&n<e&&a>=0&&a<t,s=(e,t)=>r(e,t)?a[e][t]:null,l=(e,t,n)=>a[e][t].status=n;return{placeShip:(e,t,n)=>{if(((e,t)=>{for(let n=e[0];n<=t[0];++n)for(let a=e[1];a<=t[1];++a)if(!r(n,a)||s(n,a).status!==H)return!1;return!0})(t,n)){for(let r=t[0];r<=n[0];++r)for(let s=t[1];s<=n[1];++s)a[r][s]={status:N,id:e};return!0}return!1},processIncomingAttack:e=>{const[t,n]=e,a=s(t,n);return a.status===N?l(t,n,O):a.status===H&&l(t,n,M),{coordinates:e,cell:s(t,n)}},reset:()=>a=n(e,t),getMainGrid:()=>a}})(a.numberOfRows,a.numberOfCols),l=((e=10,t=10)=>{const n=(e,t)=>Array.from({length:e},(()=>Array.from({length:t},(()=>({status:x})))));let a=n(e,t);return{getTrackingGrid:()=>a,setCellStatus:(e,t)=>{const[n,r]=e;a[n][r].status=t},reset:()=>a=n(e,t)}})(a.numberOfRows,a.numberOfCols),i=a.letterAxis,o=(()=>{const e=new Map;return{isAllShipsSunk:()=>[...e.values()].every((e=>e.isSunk())),isAllShipsPlaced:()=>[...e.values()].every((e=>e.isPlaced())),addMainShip:t=>e.set(t.id,t),getShipFromAIFleet:t=>e.get(t),getAIFleetData:()=>[...e.values()].map((e=>({id:e.id,length:e.length}))),getTotalFleetLength:()=>[...e.values()].map((e=>e.length)).reduce(((e,t)=>e+t),0),setShipPlacementCoordinates:(t,n)=>{e.get(t).setPlacedCoordinates(n)},reset:()=>e.clear()}})(),c=[];r.forEach((e=>{const t=((e,t)=>{const n=e,a=(e=>{const t=(e=>{let t=`${e}`;return t=t.replace(/\s+/g," "),t.trim()})(e);return t?t.toLowerCase().replaceAll(/ /g,"-"):null})(t),r=t,s=[];let l=n;return{id:a,length:n,isShip:()=>!0,isSunk:()=>l<=0,isPlaced:()=>s.length===n,getName:()=>r,getHealth:()=>l,setPlacedCoordinates:e=>{s.length=0,s.push(...e)},hit:()=>(l>0&&l--,l>0?O:w),reset:()=>{s.length=0,l=n}}})(e.length,e.name);o.addMainShip(t),c.push(t.getName())}));const d=(({id:e,aiName:t,difficulty:n,fleetModel:a,mainGridModel:r,trackingGridModel:s})=>{const l=t,i=r,o=s,c=a,d=(()=>{const e=[],t=t=>e.findIndex((e=>Z(e,t)));return{initializeAvailableMoves:t=>{e.length=0,t.forEach(((t,n)=>{t.forEach(((t,a)=>{t.status===x&&e.push([n,a])}))}))},getRandomMove:()=>{return(t=e)[Math.floor(Math.random()*t.length)].slice()??null;var t},getMove:n=>{const a=t(n);return-1!==a?((e,t)=>e?.slice(t,t+1)[0]??null)(e,a):null},popRandomMove:()=>ne(e),popMove:n=>{const a=t(n);return-1!==a?((e,t)=>e?.splice(t,1)[0]??null)(e,a):null},getTotalAvailableMoves:()=>e.length,getAvailableMoves:()=>e.map((e=>e.slice())),reset:()=>e.length=0}})();return{properties:{id:e,getType:()=>"ai",getName:()=>l,isAI:()=>!0,getDifficulty:()=>n},mainGrid:{get:()=>i.getMainGrid(),place:(e,t,n)=>i.placeShip(e,t,n),processIncomingAttack:e=>i.processIncomingAttack(e)},trackingGrid:{get:()=>o.getTrackingGrid(),setCellStatus:(e,t)=>o.setCellStatus(e,t)},fleet:{getData:()=>c.getAIFleetData(),getShip:e=>c.getShipFromAIFleet(e),setShipPlacementCoordinates:(e,t)=>c.setShipPlacementCoordinates(e,t),isAllShipsSunk:()=>c.isAllShipsSunk(),isAllShipsPlaced:()=>c.isAllShipsPlaced()},moves:{initialize:()=>d.initializeAvailableMoves(o.getTrackingGrid()),getAllAvailable:()=>d.getAvailableMoves(),getMove:e=>d.getMove(e),getTotalAvailable:()=>d.getTotalAvailableMoves(),getRandomMove:()=>d.getRandomMove(),popMove:e=>d.popMove(e),popRandomMove:()=>d.popRandomMove(),reset:()=>d.reset()},reset:()=>{o.reset(),i.reset(),c.reset(),d.reset()}}})({aiName:U[t],id:e,difficulty:t,fleetModel:o,mainGridModel:s,trackingGridModel:l}),u=Je(a,d.properties.getName(),c),p=d.moves.getRandomMove,g={id:d.properties.id,name:d.properties.getName(),provideTrackingGrid:()=>u.trackingGrid.elements.getGrid(),provideTrackingFleet:()=>u.fleet.getTrackingFleet(),placement:{start:e=>{if((e=>{const t=e=>e.map((e=>Array.from({length:e.length}).fill(H)));let n=t(e),a=n.length,r=n[0].length;const s=()=>{const e=[_.VERTICAL,_.HORIZONTAL];return e[Math.floor(Math.random()*e.length)]},l=(e,t,n)=>t===_.VERTICAL?((e,t)=>{const n=e[1],a=[];for(let r=e[0];r<=t;r++)a.push([r,n]);return a})(e,e[0]+n-1):((e,t)=>{const n=e[0],a=[];for(let r=e[1];r<=t;r++)a.push([n,r]);return a})(e,e[1]+n-1),i=()=>{const e=[Math.floor(Math.random()*a),Math.floor(Math.random()*r)];return n[e[0]][e[1]]!==H?i():e},o=e=>{e.forEach((e=>n[e[0]][e[1]]=N))};return{calculateRandomShipPlacements:e=>{const t=[];return e.forEach((e=>{const c=(e=>{let t=0;for(;t<250;){const c=s(),d=i(),u=l(d,c,e);if(u.every((([e,t])=>e<a&&t<r&&n[e][t]===H)))return o(u),u;t++}throw new Error(`Failed to place ship after ${t} attempts`)})(e.length);t.push({id:e.id,placement:c})})),n=n.map((e=>e.map((()=>H)))),t},updateGrid:e=>{n=t(e),a=n.length,r=n[0].length}}})(d.mainGrid.get()).calculateRandomShipPlacements(d.fleet.getData()).forEach((({id:e,placement:t})=>{d.mainGrid.place(e,t[0],t[t.length-1]),d.fleet.setShipPlacementCoordinates(e,t)})),!d.fleet.isAllShipsPlaced())throw new Error("AI Error: Not all ships placed.");e()},end:()=>{}},combat:{manager:null,init:()=>{g.combat.manager||(g.combat.manager=Tt({model:d,view:u,letterAxis:i,attackDelay:n}))},start:({sendAttack:e,sendResult:t,sendLost:n,endTurnMethod:a})=>{if(!g.combat.manager)throw new Error("Ai Combat Manager Not initialized");g.combat.manager.initializeCombat({sendAttack:e,sendResult:t,sendLost:n,endTurnMethod:a})},getHandlers:()=>g.combat.manager.getHandlers(),startTurn:()=>g.combat.manager.startTurn(),end:()=>{g.combat.manager&&(g.combat.manager.reset(),g.combat.manager=null)}},reset:()=>{g.combat.end(),d.reset()}};return{getPlayerModel:()=>d.properties,isAllShipsSunk:()=>d.fleet.isAllShipsSunk(),sendAttack:p,board:g}};var bt=n(226),ft={};ft.styleTagTransform=p(),ft.setAttributes=o(),ft.insert=l().bind(null,"head"),ft.domAPI=r(),ft.insertStyleElement=d(),t()(bt.Z,ft),bt.Z&&bt.Z.locals&&bt.Z.locals;const yt=({ManagerBuilder:e,initialDetails:t,validateDetails:n})=>{let a=t,r=null;return{getManager:()=>(r||(()=>{if(!n(a))throw new Error("Cannot initialize manager with invalid details.");r&&r.end(),r=e(a)})(),r),setDetails:t=>{r&&r.end(),a=t,r=e(a)},reset:()=>{r.end(),a=null,r=null}}},Ct=({shipPlacementManagers:e,createHandler:t,isAllShipsPlaced:n})=>{const a={ship:null,data:null},r={handler:null,getData:()=>({...a.data,rotateButton:a.ship.getRotateButton()}),emitData:()=>r.handler.emit(r.getData()),execute:({data:t})=>{s.emitFalse();const{id:n}=t;e.forEach(((e,r)=>{r===n?(e.select(),a.ship=e,a.data=t):e.isSelected()&&e.deselect()})),r.emitData()},on:e=>r.handler.on(e),off:e=>r.handler.off(e),start:()=>r.handler=t("shipSelectedFromFleet"),end:()=>r.handler.reset()},s={handler:null,emitTrue:()=>s.handler.emit(!0),emitFalse:()=>s.handler.emit(!1),start:()=>s.handler=t("allShipsInFleetPlaced"),on:e=>s.handler.on(e),off:e=>s.handler.off(e),end:()=>s.handler.reset()};return{isAllShipsPlaced:n,start:()=>{e.forEach((e=>{e.start(),e.onSelected(r.execute)})),r.start(),s.start()},end:()=>{e.forEach((e=>e.end())),r.end(),s.end()},select:()=>r.execute(),place:e=>(({data:e})=>{if(!a.ship)throw new Error("Cannot placed unselected ship.");a.ship.place(e),a.ship=null,a.data=null,n()&&s.emitTrue()})(e),onOrientationToggled:t=>(t=>e.forEach((e=>e.onOrientationToggled(t))))(t),offOrientationToggled:t=>(t=>e.forEach((e=>e.offOrientationToggled(t))))(t),onSelected:e=>r.on(e),offSelected:e=>r.off(e),onAllShipsPlaced:e=>s.on(e),offAllShipsPlaced:e=>s.off(e)}},vt=({shipCombatManagers:e,createHandler:t,isAllShipsSunk:n})=>{const a={on:t=>e.forEach((e=>e.onHit(t))),off:t=>e.forEach((e=>e.offHit(t)))},r={handler:null,check:()=>{n()&&r.handler.emit()},init:()=>{r.handler||(r.handler=t("allShipsInFleetSunk"))},on:e=>r.handler.on(e),off:e=>r.handler.off(e),reset:()=>r.handler.reset()},s={on:t=>e.forEach((e=>e.onSunk(t))),off:t=>e.forEach((e=>e.offSunk(t)))};return{start:()=>{r.init(),e.forEach((e=>{e.start(),e.onSunk(r.check)}))},end:()=>{e.forEach((e=>e.end())),r.reset()},hit:t=>{const n=e.get(t);n&&n.hit()},onShipHit:a.on,offShipHit:a.off,onShipSunk:s.on,offShipSunk:s.off,onAllShipsSunk:r.on,offAllShipsSunk:r.off}},Lt=()=>{const e={},t=t=>!!e[t],n=(n,a)=>{t(n)||(e[n]=[]),e[n].push(a)},a=(n,a)=>{t(n)&&(e[n]=e[n].filter((e=>e!==a)))};return{subscribe:n,subscribeMany:e=>e.forEach((({event:e,callback:t})=>n(e,t))),unsubscribe:a,unsubscribeMany:e=>e.forEach((({event:e,callback:t})=>a(e,t))),publish:(n,a)=>{if(!t(n))return;const r=a?.data?a:{data:a};e[n].forEach((e=>{e(r)}))},reset:()=>Object.keys(e).forEach((t=>delete e[t]))}},It=(e,t,n=(e=>e))=>{const{publish:a,subscribe:r,unsubscribe:s}=e,l=(e,n="")=>{if(!e||"function"!=typeof e)throw new Error(`${t} passed invalid function at ${n}`);return!0};l(n,It.name);let i=[],o=n;const c=e=>{l(e,c.name),i.includes(e)||(i.push(e),r(t,e))},d=e=>{l(e,d.name),o=e};return{emit:e=>{const n=o(e);a(t,n)},on:c,off:e=>{i=i.filter((t=>t!==e)),s(t,e)},setPreEmitCallback:d,reset:()=>{i.forEach((e=>s(t,e))),i=[],o=e=>e}}},Pt=e=>{const t=(()=>{const e=new Map,t=new Map;return{isAllShipsPlaced:()=>[...e.values()].every((e=>e.isPlaced())),isAllShipsSunk:()=>[...e.values()].every((e=>e.isSunk())),addMainShip:(t,n)=>e.set(t,n),addTrackingShip:e=>t.set(e.id,e),getFleet:()=>[...e.values()],getTrackingFleet:()=>[...t.values()],getShipFromMainFleet:t=>e.get(t)}})(),n=(()=>{const{mainFleetElement:e,trackingFleetElement:t}=(()=>{const{mainFleetContainer:e,trackingFleetContainer:t}={mainFleetContainer:ue(ie,{attributes:{class:"main-fleet"}}),trackingFleetContainer:ue(ie,{attributes:{class:Pe}})},{mainFleetHeader:n,trackingFleetHeader:a}={mainFleetHeader:ue(ce,{text:Ie,attributes:{class:Le}}),trackingFleetHeader:ue(ce,{text:Me,attributes:{class:ke}})},{mainShipList:r,trackingShipList:s}={mainShipList:ue(ie,{attributes:{class:ve}}),trackingShipList:ue(ie,{attributes:{class:Re}})};return e.children=[n,r],t.children=[a,s],{mainFleetElement:pe(e),trackingFleetElement:pe(t)}})(),n=new Map,a=e.querySelector(`.${ve}`),r=t.querySelector(`.${Re}`);return{attachMainFleetTo:t=>t.append(e),attachTrackingFleetTo:e=>e.append(t),addShipView:(e,t)=>n.set(e,t),populateFleetShipLists:()=>n.forEach((e=>{a.append(e.elements.getMainShip()),r.append(e.elements.getTrackingShip())})),getRotateShipButton:e=>n.get(e)?.elements.getRotateButton(),getMainFleet:()=>e,getTrackingFleet:()=>t}})(),a=new Map,r=Lt(),s=(e,t=(e=>e))=>It(r,e,t),l={manager:null,shipPlacementManagers:new Map,addShipPlacementManager:(e,t)=>l.shipPlacementManagers.set(e,t),setManager:()=>{l.manager&&l.manager.getManager().end(),l.manager=(({shipPlacementManagers:e,createHandler:t,isAllShipsPlaced:n})=>yt({ManagerBuilder:Ct,initialDetails:{shipPlacementManagers:e,createHandler:t,isAllShipsPlaced:n},validateDetails:e=>e.shipPlacementManagers&&e.createHandler&&e.isAllShipsPlaced}))({shipPlacementManagers:l.shipPlacementManagers,createHandler:s,isAllShipsPlaced:t.isAllShipsPlaced})},getPlacementManager:()=>(l.manager||l.setManager(),l.manager.getManager())},i={manager:null,shipCombatManagers:new Map,addShipCombatManager:(e,t)=>i.shipCombatManagers.set(e,t),setManger:()=>{i.manager&&i.manager.getManager().end(),i.manager=(({shipCombatManagers:e,createHandler:t,isAllShipsSunk:n})=>yt({ManagerBuilder:vt,initialDetails:{shipCombatManagers:e,createHandler:t,isAllShipsSunk:n},validateDetails:e=>e.shipCombatManagers&&e.createHandler&&e.isAllShipsSunk}))({shipCombatManagers:i.shipCombatManagers,createHandler:s,isAllShipsSunk:t.isAllShipsSunk})},getCombatManager:()=>(i.manager||i.setManger(),i.manager.getManager())},o=e=>{const r=e.getModel(),s=r.id;t.addMainShip(s,r),a.set(s,e),n.addShipView(s,e.getView()),n.populateFleetShipLists(),l.addShipPlacementManager(s,e.getPlacementManager()),i.addShipCombatManager(s,e.getCombatManager())};return e&&e.forEach(o),{getPlacementManager:()=>l.getPlacementManager(),getCombatManager:()=>i.getCombatManager(),view:n,getModel:()=>t,getTrackingFleet:()=>n.getTrackingFleet(),assignShipToFleet:o}},Rt="base-button",kt=(e,t,n)=>ue(n,{attributes:{class:`${t} ${fe}`,[Ce.SHIP_NAME]:t,[Ce.SHIP_SUNK]:"false"},children:[ue(ce,{text:e,attributes:{class:ye}})]});var Mt=n(320),Ot={};Ot.styleTagTransform=p(),Ot.setAttributes=o(),Ot.insert=l().bind(null,"head"),Ot.domAPI=r(),Ot.insertStyleElement=d(),t()(Mt.Z,Ot),Mt.Z&&Mt.Z.locals&&Mt.Z.locals;const wt=()=>{const e=new Map,t=new Map,n=n=>{n.isActive()?(e.set(n.getKey(),n),t.delete(n.getKey())):(t.set(n.getKey(),n),e.delete(n.getKey()))},a={addController:({element:n,event:a,callback:r,key:s,enable:l=!1})=>{const i=(({element:e,event:t,callback:n,key:a})=>{(e=>{const{element:t,event:n,callback:a,key:r}=e;if(!(t===document||t&&t instanceof HTMLElement))throw new Error(`Invalid Element: ${t}`);if(!n||"string"!=typeof n)throw new Error(`Invalid Event String: ${n}`);if(!a||"function"!=typeof a)throw new Error(`Invalid Callback Function: ${a}`);if(!r||"string"!=typeof r)throw new Error(`Invalid key string: ${r}`)})({element:e,event:t,callback:n,key:a});let r=!1;const s={enable:()=>{if(!r)return e.addEventListener(t,n),"BUTTON"===e.tagName&&(e.disabled=!1),r=!0,s},disable:()=>{if(r)return e.removeEventListener(t,n),"BUTTON"===e.tagName&&(e.disabled=!0),r=!1,s},isActive:()=>r,getKey:()=>a};return s})({element:n,event:a,callback:r,key:s});l?(i.enable(),e.set(s,i)):t.set(s,i)},enableListener:e=>{const a=t.get(e)?.enable();a&&n(a)},disableListener:t=>{const a=e.get(t)?.disable();a&&n(a)},enableAllListeners:()=>t.forEach(((e,t)=>a.enableListener(t))),disableAllListeners:()=>e.forEach(((e,t)=>a.disableListener(t))),removeListener:e=>{a.disableListener(e),t.delete(e)},reset:()=>{a.disableAllListeners(),t.clear()}};return a},xt="mainShipSelect",Nt="mouseToggleOrientation",Ht="keyToggleOrientation",Dt="buttonToggleOrientation",_t=({model:e,view:t,createHandler:n})=>{const a=(({model:e,view:t})=>{let n=!1,a=!1;const r=(({mainShipElement:e,rotateButtonElement:t})=>{const n=wt(),{addController:a,enableListener:r,disableListener:s,removeListener:l}=n;let i=!1;const o=()=>r(xt),c=()=>s(xt),d=()=>{r(Dt),r(Nt),r(Ht)},u=()=>{s(Dt),s(Nt),s(Ht)};return{initialize:({requestSelectionCallback:n,toggleOrientationCallback:r})=>(({requestSelectionCallback:n,toggleOrientationCallback:r})=>{i||(a({element:e,event:we,callback:n,key:xt,enable:!0}),a({element:document,event:"mousedown",callback:r,key:Nt,enable:!1}),a({element:document,event:Ne,callback:r,key:Ht,enable:!1}),a({element:t,event:we,callback:r,key:Dt,enable:!0}),i=!0)})({requestSelectionCallback:n,toggleOrientationCallback:r}),enable:{select:()=>o(),orientationToggle:()=>d(),all:()=>{o(),d()}},disable:{select:()=>c(),orientationToggle:()=>u(),all:()=>{c(),u()}},update:{orientation:t=>e.dataset.orientation=t,selectedStatus:t=>e.classList.toggle("ship-selected",t)},reset:()=>{l(xt),l(Dt),l(Nt),l(Ht),t.remove(),n.reset(),i=!1}}})({mainShipElement:t.elements.getMainShip(),rotateButtonElement:t.elements.getRotateButton()}),s=t=>{if(!(e=>e.code===De||e.code===He||1===e.button||e.target.classList.contains("rotate-ship-button")&&e instanceof PointerEvent)(t))return;t.preventDefault(),e.toggleOrientation();const n=e.getOrientation();return r.update.orientation(n),!0},l=()=>{a||(r.enable.select(),a=!0)},i=()=>{a&&(r.disable.all(),a=!1)};return{initialize:(e,t)=>{n||(r.initialize({requestSelectionCallback:e,toggleOrientationCallback:e=>{s(e)&&t()}}),l(),n=!0)},reset:()=>{n&&(i(),r.reset(),n=!1)},select:()=>{e.isSelected()||(r.update.selectedStatus(!0),r.enable.orientationToggle(),e.setIsSelected(!0))},deselect:()=>{e.isSelected()&&(r.disable.orientationToggle(),r.update.selectedStatus(!1),e.setIsSelected(!1))},toggleOrientation:s,enable:l,disable:i}})({model:e,view:t}),r=(({model:e,view:t})=>({place:n=>{e.setPlacedCoordinates(n),e.setIsPlaced(!0),t.elements.getMainShip().dataset.placed=Ae},pickup:()=>{e.clearPlacedCoordinates(),e.setIsPlaced(!1),t.elements.getMainShip().dataset.placed=be}}))({model:e,view:t}),s=()=>e.isPlaced(),l={handler:null,execute:e=>{r.place(e),i.deselect(),l.handler.emit()},on:e=>l.handler.on(e),off:e=>l.handler.off(e),init:()=>l.handler=n("shipPlaced"),reset:()=>l.handler.reset()},i={handler:null,execute:()=>{s()&&r.pickup(),a.select()},request:()=>i.handler.emit(),deselect:()=>a.deselect(),getData:()=>({id:e.id,length:e.length,orientation:e.getOrientation()}),on:e=>i.handler.on(e),off:e=>i.handler.off(e),init:()=>i.handler=n("shipSelected",i.getData),reset:()=>i.handler.reset()},o={handler:null,request:()=>o.handler.emit(),on:e=>o.handler.on(e),off:e=>o.handler.off(e),init:()=>o.handler=n("shipOrientationToggled",e.getOrientation),reset:()=>o.handler.reset()};return{isSelected:()=>e.isSelected(),isPlaced:s,getRotateButton:()=>t.elements.getRotateButton(),start:()=>{i.init(),o.init(),l.init(),a.initialize(i.request,o.request)},end:()=>{i.reset(),o.reset(),l.reset(),a.reset()},place:e=>l.execute(e),select:()=>i.execute(),deselect:()=>i.deselect(),onSelected:e=>i.on(e),offSelected:e=>i.off(e),onPlaced:e=>l.on(e),offPlaced:e=>l.off(e),onOrientationToggled:e=>o.on(e),offOrientationToggled:e=>o.off(e)}},Bt=({model:e,view:t,createHandler:n})=>{const a={handler:null,getData:()=>({id:e.id,isSunk:e.isSunk()}),emitData:()=>a.handler.emit(a.getData()),execute:()=>{e.hit()===w&&r.execute(),a.emitData()},on:e=>a.handler.on(e),off:e=>a.handler.off(e),init:()=>a.handler=n("shipHit"),reset:()=>a.handler.reset()},r={handler:null,execute:()=>{t.elements.getMainShip().setAttribute(Ce.SHIP_SUNK,Ae),t.elements.getTrackingShip().setAttribute(Ce.SHIP_SUNK,Ae),r.handler.emit(e.id)},on:e=>r.handler.on(e),off:e=>r.handler.off(e),init:()=>r.handler=n("shipSunk"),reset:()=>r.handler.reset()};return{start:()=>{a.init(),r.init()},end:()=>{a.reset(),r.reset()},hit:a.execute,onHit:e=>a.on(e),offHit:e=>a.off(e),onSunk:e=>r.on(e),offSunk:e=>r.off(e)}},Ut=e=>{const{name:t,length:n}=e,a=(({shipLength:e,shipName:t})=>{const n=e,a=[],r=t,s=t.toLowerCase().replace(/ /g,"-");let l=!1,i=!1,o=n,c=_.VERTICAL;return{id:s,length:n,name:r,isShip:()=>!0,isSunk:()=>o<=0,isSelected:()=>i,isPlaced:()=>l,getHealth:()=>o,getOrientation:()=>c,getPlacedCoordinates:()=>a.map((e=>[...e])),setIsPlaced:e=>l=e,setIsSelected:e=>i=e,setPlacedCoordinates:e=>{a.length=0,a.push(...e)},clearPlacedCoordinates:()=>a.length=0,toggleOrientation:()=>c=c===_.VERTICAL?_.HORIZONTAL:_.VERTICAL,hit:()=>(o>0&&o--,o>0?O:w),reset:()=>{a.length=0,o=n,i=!1}}})({shipName:t,shipLength:n}),r=(({name:e,length:t})=>{const{mainShipElement:n,trackingShipElement:a,rotateButtonElement:r}=(({name:e,length:t})=>{const n=e.toLowerCase().replace(/ /g,"-"),a=kt(e,n,de),r=kt(e,n,ie),s=((e,t)=>(e.attributes[Ce.SHIP_LENGTH]=t,e.attributes[Ce.SHIP_ORIENTATION]=_.VERTICAL,e.attributes[Ce.SHIP_PLACED]=be,e.children.push(ue(ce,{text:t})),e))(a,t);return{mainShipElement:pe(s),trackingShipElement:pe(r),rotateButtonElement:pe(ue(de,{text:"Rotate Ship",attributes:{class:`rotate-ship-button ${Rt}`}}))}})({name:e,length:t});return{elements:{getMainShip:()=>n,getTrackingShip:()=>a,getRotateButton:()=>r}}})({name:t,length:n}),s=a.id,l=Lt(),i=(e,t=(e=>e))=>It(l,e,t),o=(({model:e,view:t,createHandler:n})=>yt({ManagerBuilder:_t,initialDetails:{model:e,view:t,createHandler:n},validateDetails:e=>e.model&&e.view&&e.createHandler}))({model:a,view:r,createHandler:i}),c=(({model:e,view:t,createHandler:n})=>yt({ManagerBuilder:Bt,initialDetails:{model:e,view:t,createHandler:n},validateDetails:e=>e.model&&e.view&&e.createHandler}))({model:a,view:r,createHandler:i});return{id:s,name:t,getPlacementManager:()=>o.getManager(),getCombatManager:()=>c.getManager(),view:{getMainShipElement:()=>r.elements.getMainShip(),getTrackingShipElement:()=>r.elements.getTrackingShip()},getModel:()=>a,getView:()=>r}},$t={TYPE:"main-grid",CLASSES:{HEADER:"main-grid-header",WRAPPER:"main-grid-wrapper",HIT_MARKER:"main-grid-hit-marker",VALID_PLACEMENT:"valid-placement",INVALID_PLACEMENT:"invalid-placement",PLACED_ENTITY:"placed-ship"},PROPERTIES:{CELL_ELEMENT:ie,HEADER_TEXT:"Home Territory",ATTRIBUTES:{CELL_COORDINATES_DATA:Te("coordinates"),PLACED_ENTITY_NAME:Te("placed-ship-name")}},get INVALID_PLACEMENT_SELECTOR(){return`${$t.PROPERTIES.CELL_ELEMENT}.${$t.CLASSES.INVALID_PLACEMENT}`},get VALID_PLACEMENT_SELECTOR(){return`${$t.PROPERTIES.CELL_ELEMENT}.${$t.CLASSES.VALID_PLACEMENT}`},CELL_SELECTOR:e=>Be({elementType:$t.PROPERTIES.CELL_ELEMENT,attribute:$t.PROPERTIES.ATTRIBUTES.CELL_COORDINATES_DATA,value:e}),PLACED_ENTITY_SELECTOR:e=>Be({elementType:$t.PROPERTIES.CELL_ELEMENT,attribute:$t.PROPERTIES.ATTRIBUTES.PLACED_ENTITY_NAME,value:e})};var Gt=n(614),Ft={};Ft.styleTagTransform=p(),Ft.setAttributes=o(),Ft.insert=l().bind(null,"head"),Ft.domAPI=r(),Ft.insertStyleElement=d(),t()(Gt.Z,Ft),Gt.Z&&Gt.Z.locals&&Gt.Z.locals;const qt="invalid-placement",Yt="valid-placement",Wt=({gridElement:e=null,maxVertical:t=null,maxHorizontal:n=null,letterAxis:a=null,getCell:r=null}={})=>{const s={coordinates:null},l={element:e,maxVertical:t,maxHorizontal:n,letterAxis:a,getCell:r},i={orientation:null,length:null},o=()=>{l.element.querySelectorAll(`.${Yt}, .${qt}`).forEach((e=>{e.classList.remove(Yt,qt)}))},c=e=>{(e=>{o(l.element),e.forEach((e=>{const t=l.getCell(e);(e=>e.classList.contains("placed-ship"))(t)?t.classList.add(qt):t.classList.add(Yt)}))})((e=>{const t=i.orientation===_.VERTICAL,n=[],a=W(e),r=t?{max:l.maxVertical,startCoordinate:a[0]}:{max:l.maxHorizontal,startCoordinate:a[1]},{start:s,end:o}=((e,t,n)=>{const a=Math.min(e+t-1,n);return{start:Math.max(a-t+1,0),end:a}})(r.startCoordinate,i.length,r.max),c=t?(e,t)=>z(e,t[1],l.letterAxis):(e,t)=>z(t[0],e,l.letterAxis);for(let e=s;e<=o;e++)n.push(c(e,a));return n})(e))},d=e=>{if(!i.orientation)return;e.target.classList.contains(Ue.CLASSES.CELL)||(s.coordinates=null,o());const t=e.target.closest(Ue.CELL_SELECTOR);t&&(s.coordinates=t.dataset.coordinates,s.coordinates&&c(s.coordinates))};return{enable:()=>{l.element.addEventListener(xe,d)},disable:()=>{o(),l.element.removeEventListener(xe,d)},updateOrientation:e=>{o(),i.orientation=e,s.coordinates&&c(s.coordinates)},setCurrentEntity:({length:e,orientation:t})=>{o(),i.length=e,i.orientation=t},initializeGrid:({element:e,maxVertical:t,maxHorizontal:n,letterAxis:a,getCell:r})=>{l.element=e,l.maxVertical=t,l.maxHorizontal=n,l.letterAxis=a,l.getCell=r},reset:()=>{l.element?.removeEventListener(xe,d),l.element=null,l.maxVertical=null,l.maxHorizontal=null,l.letterAxis=null,l.getCell=null,i.length=null,i.orientation=null}}},zt="submitPlacements",Zt="entityRequestPlacement",Vt=({mainGridElement:e,submitPlacementsButtonElement:t,previewConfig:n})=>{let a=!1;const r=wt(),s=Wt(n),l=()=>r.enableListener(zt),i=()=>r.disableListener(zt),o=()=>{s.enable(),r.enableListener(Zt)},c=()=>{s.disable(),r.disableListener(Zt)};return{initialize:(n,l)=>{a||(r.addController({key:zt,element:t,event:we,callback:n,enable:!1}),r.addController({element:e,event:we,callback:l,key:Zt,enable:!1}),s.enable(),a=!0)},processPlacementRequest:t=>{if(null!==e.querySelector($t.INVALID_PLACEMENT_SELECTOR)||null===e.querySelector($t.VALID_PLACEMENT_SELECTOR))return;const n=[...e.querySelectorAll($t.VALID_PLACEMENT_SELECTOR)];return((e,t)=>{e.forEach((e=>{e.classList.replace($t.CLASSES.VALID_PLACEMENT,$t.CLASSES.PLACED_ENTITY),e.setAttribute($t.PROPERTIES.ATTRIBUTES.PLACED_ENTITY_NAME,t),e.textContent=t.charAt(0).toUpperCase()})),s.disable()})(n,t),n.map((e=>e.dataset.coordinates))},enable:{placementRequest:()=>o(),submitPlacements:()=>l(),all:()=>{o(),l()}},disable:{placementRequest:()=>c(),submitPlacements:()=>i(),all:()=>{c(),i()}},update:{preview:{selectedEntity:({id:t,length:n,orientation:a})=>{var r;r=t,null!==e.querySelector($t.PLACED_ENTITY_SELECTOR(r))&&(t=>{const n=(t=>e.querySelectorAll($t.PLACED_ENTITY_SELECTOR(t)))(t);n.forEach((e=>{e.classList.remove($t.CLASSES.PLACED_ENTITY),e.removeAttribute($t.PROPERTIES.ATTRIBUTES.PLACED_ENTITY_NAME),e.textContent=""}))})(t),s.setCurrentEntity({length:n,orientation:a}),s.enable()},orientation:e=>s.updateOrientation(e)},submitPlacementsButtonContainer:e=>{t.remove(),e.append(t)}},reset:()=>{s.reset(),r.reset(),t.remove(),a=!1}}},jt=({model:e,view:t,createHandler:n})=>{const a=(({model:e,view:t})=>{let n=!1,a=null;const r={gridElement:t.elements.getWrapper(),getCell:t.getCell,maxVertical:e.getMaxVertical(),maxHorizontal:e.getMaxHorizontal(),letterAxis:e.getLetterAxis()},s=Vt({mainGridElement:t.elements.getGrid(),submitPlacementsButtonElement:t.elements.getSubmitPlacementsButton(),previewConfig:r});return{initialize:(t,r)=>{n||(s.initialize(t,(t=>{const n=(t=>{if(0!==t.button)return;if(!a)throw new Error("Entity must be selected for placement.");const n=s.processPlacementRequest(a)?.map(W);return!!n&&(e.place(n,a),s.disable.placementRequest(),a=null,n)})(t);n&&r(n)})),n=!0)},reset:()=>{n&&(s.reset(),n=!1)},toggleSubmission:e=>{e?s.enable.submitPlacements():s.disable.submitPlacements()},updateOrientation:e=>s.update.preview.orientation(e),updateSelectedEntity:(t,n,r)=>{e.isEntityPlaced(t)&&e.removePlacedEntity(t),s.update.preview.selectedEntity({id:t,length:n,orientation:r}),s.enable.placementRequest(),a=t}}})({model:e,view:t}),r={handler:null,execute:e=>{e&&r.handler.emit(e)},on:e=>r.handler.on(e),off:e=>r.handler.off(e),init:()=>r.handler=n("gridPlacementProcessed"),reset:()=>r.handler.reset()},s={handler:null,execute:()=>{a.reset(),s.handler.emit()},toggle:({data:e})=>a.toggleSubmission(e),on:e=>s.handler.on(e),off:e=>s.handler.off(e),init:()=>s.handler=n("gridPlacementsFinalizationRequested"),reset:()=>s.handler.reset()};return{start:()=>{r.init(),s.init(),a.initialize(s.execute,r.execute)},end:()=>{s.reset(),r.reset(),a.reset()},updateOrientation:({data:e})=>a.updateOrientation(e),updateSelectedEntity:({data:e})=>{const{id:t,length:n,orientation:r}=e;a.updateSelectedEntity(t,n,r)},toggleSubmit:e=>s.toggle(e),onPlace:e=>r.on(e),offPlace:e=>r.off(e),onSubmit:e=>s.on(e),offSubmit:e=>s.off(e)}},Xt=({model:e,view:t,createHandler:n})=>{const a={handler:null,process:({data:n})=>{const{coordinates:r,cellValue:s}=e.processIncomingAttack(n),[l,i]=n,o=z(l,i,e.getLetterAxis());s.status===O&&t.displayShipHit(o),a.handler.emit({coordinates:r,cellValue:s})},init:()=>{a.handler||(a.handler=n("incomingAttackProcessed"))},on:e=>a.handler.on(e),off:e=>a.handler.off(e),reset:()=>a.handler.reset()};return{processIncomingAttack:a.process,start:a.init,end:a.reset,onIncomingAttackProcessed:a.on,offIncomingAttackProcessed:a.off}},Kt=e=>{const{numberOfRows:t,numberOfCols:n,letterAxis:a}=e,r=(({numberOfRows:e=10,numberOfCols:t=10,letterAxis:n="row"}={})=>{if(e>26||t>26)throw new Error("Board cannot have more than 26 rows or columns.");const a=tt(e,t,{status:H,id:null}),r=a.length-1,s=a[0].length-1,l=e=>nt(a,e),i=e=>st(a,e),o=(e,t)=>{const[n,r]=e;a[n][r].status=t},c=(({mainGrid:e,isInBounds:t})=>{const n=new Map;return{getPlacedEntityMap:()=>n,placeEntity:(a,r)=>{const s=a[0],l=a[a.length-1],i=[];if(((n,a)=>{if(!t(n)||!t(a))return!1;for(let t=n[0];t<=a[0];++t)for(let r=n[1];r<=a[1];++r)if(!e[t][r].status===H)return!1;return!0})(s,l)){for(let t=s[0];t<=l[0];++t)for(let n=s[1];n<=l[1];++n){const a=[t,n];i.push(a),e[t][n]={status:N,id:r}}return n.set(r,i),!0}return!1},removePlacedEntity:t=>{const a=n.get(t);a&&(a.forEach((([t,n])=>e[t][n]={status:H})),n.delete(t))},isEntityPlaced:e=>n.has(e),reset:()=>n.clear()}})({mainGrid:a,valueAt:i,setCellStatus:o,isInBounds:l});return{place:(e,t)=>c.placeEntity(e,t),removePlacedEntity:e=>c.removePlacedEntity(e),isEntityPlaced:e=>c.isEntityPlaced(e),getEntityPlacements:()=>c.getPlacedEntityMap(),processIncomingAttack:e=>{const t=i(e);return t.status===N?o(e,O):o(e,M),{coordinates:e,cellValue:t}},isInBounds:l,setCellStatus:o,getMainGrid:()=>at(a),getLetterAxis:()=>n,getMaxVertical:()=>r,getMaxHorizontal:()=>s,getDimensions:()=>({width:a[0].length,height:a.length}),reset(){a.length=0,c.reset(),a.push(...tt(e,t))}}})({numberOfRows:t,numberOfCols:n,letterAxis:a}),s=(({numberOfRows:e,numberOfCols:t,letterAxis:n})=>{const a={},r=()=>{const{wrappedMainGridElement:r,submitPlacementsButtonElement:s}=(({numberOfRows:e,numberOfCols:t,letterAxis:n})=>{const a=Ge({headerClass:`${$t.CLASSES.HEADER} grid-header`,headerText:$t.PROPERTIES.HEADER_TEXT}),r=Fe(n),s=qe({count:t,type:r.col,axisLabelClass:Ue.CLASSES.LABELS.COL}),l=qe({count:e,type:r.row,axisLabelClass:Ue.CLASSES.LABELS.ROW}).map((e=>ze({rowLabelObj:e,cellObjs:s.map((t=>{return n=`${e.text}${t.text}`,We({elementType:$t.PROPERTIES.CELL_ELEMENT,attributes:{[$t.PROPERTIES.ATTRIBUTES.CELL_COORDINATES_DATA]:`${n}`}});var n}))}))),i=ue(ie,{attributes:{class:`${$t.CLASSES.WRAPPER} grid-wrapper`},children:[ue(ie,{attributes:{class:$t.TYPE},children:[a,Ye({labels:s}),...l]})]}),o=ue(de,{text:"Submit Placements",attributes:{class:`${Rt} submit-ships-placement-button`,disabled:""}});return{wrappedMainGridElement:pe(i),submitPlacementsButtonElement:pe(o)}})({numberOfRows:e,numberOfCols:t,letterAxis:n}),l=r.querySelector(`.${$t.TYPE}`);Object.assign(a,{wrappedMainGridElement:r,submitPlacementsButtonElement:s,grid:l})},s=e=>a.grid.querySelector($t.CELL_SELECTOR(e));return r(),{getCell:s,attachTo:e=>e.append(a.wrappedMainGridElement),attachWithinWrapper:e=>a.wrappedMainGridElement.append(e),displayShipHit:e=>{s(e).classList.add($t.CLASSES.HIT_MARKER)},elements:{getWrapper:()=>a.wrappedMainGridElement,getGrid:()=>a.grid,getSubmitPlacementsButton:()=>a.submitPlacementsButtonElement},reset:()=>{r()}}})({numberOfRows:t,numberOfCols:n,letterAxis:a}),l=Lt(),i=(e,t=(e=>e))=>It(l,e,t),o=(({model:e,view:t,createHandler:n})=>yt({ManagerBuilder:jt,initialDetails:{model:e,view:t,createHandler:n},validateDetails:e=>e.model&&e.view&&e.createHandler}))({model:r,view:s,createHandler:i}),c=(({model:e,view:t,createHandler:n})=>yt({ManagerBuilder:Xt,initialDetails:{model:e,view:t,createHandler:n},validateDetails:e=>e.model&&e.view&&e.createHandler}))({model:r,view:s,createHandler:i});return{getPlacementManager:()=>o.getManager(),getCombatManager:()=>c.getManager(),view:{attachTo:e=>s.attachTo(e),attachWithinWrapper:e=>s.attachWithinWrapper(e),getGrid:()=>s.elements.getGrid(),getWrapper:()=>s.elements.getWrapper(),getSubmitButton:()=>s.elements.getSubmitPlacementsButton(),hide:()=>s.hide(),show:()=>s.show(),enable:()=>s.enable(),disable:()=>s.disable()}}},Qt="sendAttack",Jt=({view:e,createHandler:t})=>{const n=(e=>{const t=e.elements.getGrid();let n=!1,a=null;const r=wt();return{initialize:s=>{n||(r.addController({element:t,key:Qt,event:we,callback:t=>{const n=(e=>e.target.closest(`${$e.PROPERTIES.CELL_ELEMENT}.${Ue.CLASSES.CELL}`)?.value)(t);n&&(a=e.getCell(n),s(n))},enable:!1}),n=!0)},displayResult:t=>{e.setCellStatus(a,t),a=null},enable:()=>{e.enable(),r.enableListener(Qt)},disable:()=>{e.disable(),r.disableListener(Qt)},end:()=>{n&&(r.reset(),n=!1)}}})(e),a={handler:null,process:({data:e})=>{const{result:t}=e;n.displayResult(t),a.handler.emit()},on:e=>a.handler.on(e),off:e=>a.handler.off(e),initialize:()=>a.handler=t("sentAttackResultProcessed"),end:()=>r.handler.reset()},r={handler:null,send:e=>{const t=W(e);r.handler.emit(t)},enable:()=>n.enable(),disable:()=>n.disable(),on:e=>r.handler.on(e),off:e=>r.handler.off(e),initialize:()=>r.handler=t("attackSent"),end:()=>r.handler.reset()};return{start:()=>{r.initialize(),a.initialize(),n.initialize(r.send)},end:()=>{r.end(),n.end(),a.end()},enable:r.enable,disable:r.disable,acceptResult:a.process,onResultProcessed:a.on,offResultProcessed:a.off,onSendAttack:r.on,offSendAttack:r.off}},en=({numberOfRows:e,numberOfCols:t,letterAxis:n})=>{const a=je({numberOfRows:e,numberOfCols:t,letterAxis:n}),r=Lt(),s=(({view:e,createHandler:t})=>yt({ManagerBuilder:Jt,initialDetails:{view:e,createHandler:t},validateDetails:e=>e.view&&e.createHandler}))({view:a,createHandler:(e,t=(e=>e))=>It(r,e,t)});return{getCombatManager:()=>s.getManager(),view:{attachTo:e=>a.attachTo(e),attachWithinWrapper:e=>a.attachWithinWrapper(e),getGrid:()=>a.elements.getGrid(),getWrapper:()=>a.elements.getWrapper(),hide:()=>a.hide(),show:()=>a.show(),enable:()=>a.enable(),disable:()=>a.disable()}}},tn=({playerSettings:e,boardSettings:t,fleetData:n})=>{const a={model:null,controllers:null};if(e.type===v){const{id:r,difficulty:s,attackDelay:l}=e,i=At({id:r,difficulty:s,boardSettings:t,fleetData:n,attackDelay:l});a.model=i.getPlayerModel(),a.controllers=i}else{const{username:r,id:s,type:l}=e;a.model=(({playerName:e="",playerType:t,playerId:n})=>{if(!n||"string"!=typeof n)throw new Error("Player ID not provided.");let a=l(e),r=t;const s=n;function l(e){return"string"==typeof e&&e.trim()?e.trim():"Mutinous"}return{id:s,isPlayer:()=>!0,getName:()=>a,getId:()=>s,getType:()=>r,setName:e=>a=l(e),setType:e=>r=e}})({playerName:r,playerType:l,playerId:s}),a.controllers=((e,t)=>({fleet:Pt(e.map((e=>Ut(e)))),mainGrid:Kt(t),trackingGrid:en(t)}))(n,t)}return a},nn=({placementView:e,placementManagers:t})=>{const{fleet:n,mainGrid:a}=t;let r=!1;const s=t=>{if(r){if(t&&!n.isAllShipsPlaced())throw new Error("Not all ships have been placed");e.endTurn(),a.end(),n.end(),r=!1}};return{startPlacement:t=>{(l=>{const{updateRotateButton:i,removeRotateButton:o}=e.init();a.start(),n.start(),n.onSelected((e=>{i(e),a.updateSelectedEntity(e)})),n.onOrientationToggled(a.updateOrientation),n.onAllShipsPlaced(a.toggleSubmit),a.onPlace((e=>{n.place(e),o()})),a.onSubmit((()=>{s(!0),t&&t()})),r=!0})(),e.startTurn()},endPlacement:s}};var an=n(698),rn={};rn.styleTagTransform=p(),rn.setAttributes=o(),rn.insert=l().bind(null,"head"),rn.domAPI=r(),rn.insertStyleElement=d(),t()(an.Z,rn),an.Z&&an.Z.locals&&an.Z.locals;const sn="board",ln="board-buttons-container",on="player-name-display",cn="board-button-wrapper",dn="board-utility-container",un="main-grid-utility-container",pn="tracking-grid-utility-container",gn="main-grid-button-container",mn="tracking-fleet-container",hn=e=>{let t=dn;return e&&(t=`${t} ${e}`),ge(ie,{attributes:{class:t}})},Sn=({playerId:e,playerName:t,controllers:n,gameMode:a,displayContainer:r})=>{const{fleet:s,mainGrid:l,trackingGrid:i}=n,o=e,c=t,d=(({playerId:e,playerName:t,displayContainer:n=document.querySelector("body"),views:a})=>{const{mainGrid:r,trackingGrid:s,fleet:l}=a;let i=null,o=null,c=null;const d=()=>{o&&p(),o=(e=>ge(ie,{attributes:{class:sn,id:`${e}-board`}}))(e);const n=(e=>ge(ie,{text:e,attributes:{class:on}}))(t);c=ge(ie,{attributes:{class:mn}});const a=hn(un),d=((e=null)=>{let t=ln;return e&&(t=`${t} ${e}`),ge(ie,{attributes:{class:t}})})(gn),u=hn(pn);o.append(n),r.attachTo(o),s.attachTo(o),r.attachWithinWrapper(a),l.attachMainFleetTo(a),a.append(d),s.attachWithinWrapper(u),u.append(c),i=(e=>{const t={},n=e=>ge(ie,{attributes:{class:`${e}-${cn}`}}),a=a=>{const r=n(a);e.append(r),t[a]=r},r=e=>(t[e]||a(e),t[e]),s=e=>{t[e]&&(t[e].textContent="")};return{addWrapper:a,getWrapper:r,updateButton:(e,t)=>{const n=r(e);n.textContent="",n.append(t)},addButton:(e,t)=>{let a=r(e);a||n(e),a=r(e),a.append(t)},removeButton:s,removeWrapper:e=>{t[e]&&(s(e),delete t[e])}}})(d)},u=()=>n.append(o),p=()=>o.remove();d();const g=(({buttonManager:e,fleet:t,mainGrid:n,trackingGrid:a,display:r,remove:s})=>({init:()=>({removeRotateButton:()=>e.removeButton("rotate-ship"),updateRotateButton:({data:n})=>{const{id:a}=n;e.updateButton("rotate-ship",t.getRotateShipButton(a))}}),startTurn:()=>{a.disable(),a.hide(),e.addButton("submit-placements",n.getSubmitButton()),e.addWrapper("rotate-ship"),r()},endTurn:()=>{e.removeWrapper("submit-placements"),e.removeWrapper("rotate-ship"),a.show(),s()}}))({buttonManager:i,fleet:l,mainGrid:r,trackingGrid:s,display:u,remove:p}),m={endTurnBtn:null,setEndTurnButton:e=>{m.endTurnBtn=e,i.addButton("endTurn",e),m.endTurnBtn.addEventListener(we,m.endTurn)},startTurn:()=>u(),endTurn:()=>p(),reset:()=>{m.endTurnBtn&&(m.endTurnBtn.removeEventListener(we,m.endTurn),m.endTurnBtn=null,i.removeWrapper("endTurn")),p()}};return{display:u,remove:p,init:(e,t=null)=>{c.textContent="",c.prepend(e),t&&s.attachWithinWrapper(t)},provideTrackingFleet:()=>l.getTrackingFleet(),placementView:g,combatView:m,reset:()=>d()}})({playerId:e,playerName:t,displayContainer:r,gameMode:a,views:{mainGrid:l.view,trackingGrid:i.view,fleet:s.view}}),u={manager:null,loadManager:()=>{u.manager||(u.manager=nn({placementView:d.placementView,placementManagers:{fleet:s.getPlacementManager(),mainGrid:l.getPlacementManager()}}))},startPlacement:e=>{u.manager||u.loadManager(),u.manager.startPlacement((()=>{u.manager=null,e()}))},endPlacement:()=>{u.manager&&(u.manager.endPlacement(),u.manager=null)}},p={manager:null,loadManager:()=>{p.manager||(p.manager=(({playerId:e,combatManagers:t,combatView:n})=>{const{trackingGrid:a,fleet:r,mainGrid:s}=t,l={attack:()=>{},result:()=>{},lost:()=>{},endTurn:()=>{},reset:()=>{l.attack=()=>{},l.result=()=>{},l.endTurn=()=>{}}},i={isInitialized:!1,onLost:null,lastSunk:null,allShipsSunk:!1,handleRequest:e=>s.processIncomingAttack(e),updateLastSunk:({data:e})=>i.lastSunk=e,triggerAllShipsSunk:()=>i.allShipsSunk=!0,process:({data:t})=>{const{coordinates:n,cellValue:a}=t,{status:s,id:o}=a;let c={result:s};s===O&&(r.hit(o),i.lastSunk&&(i.lastSunk===o?c={result:w,id:o}:i.lastSunk=null)),l.result({coordinates:n,...c}),i.allShipsSunk&&l.lost({id:e})},init:()=>{i.isInitialized||(s.onIncomingAttackProcessed(i.process),r.onAllShipsSunk(i.triggerAllShipsSunk),i.isInitialized=!0)}},o={isInitialized:!1,sendRequest:e=>{a.disable(),l.attack(e)},handleIncomingResultRequest:e=>a.acceptResult(e),init:()=>{o.isInitialized||(a.onSendAttack(o.sendRequest),r.onShipSunk(i.updateLastSunk),o.isInitialized=!0)}};return{initializeCombat:e=>{const{sendAttack:t,sendResult:c,sendLost:d,endTurnMethod:u}=e;l.attack=t,l.result=c,l.lost=d,r.start(),s.start(),a.start(),o.init(),i.init(),"function"==typeof u?a.onResultProcessed(u):n.setEndTurnButton(u)},startTurn:()=>{n.startTurn(),a.enable()},incomingAttackHandler:i.handleRequest,incomingResultHandler:o.handleIncomingResultRequest,reset:()=>{s.end(),a.end(),r.end(),l.reset(),i.onLost=null,i.isInitialized=!1,o.isInitialized=!1,i.lastSunk=null,i.allShipsSunk=!1,n.reset()}}})({combatView:d.combatView,playerId:e,combatManagers:{fleet:s.getCombatManager(),mainGrid:l.getCombatManager(),trackingGrid:i.getCombatManager()}}))},startCombat:({sendAttack:e,sendResult:t,sendLost:n,endTurnMethod:a})=>{if(!p.manager)throw new Error("Board Combat Manager Not initialized");p.manager.initializeCombat({sendAttack:e,sendResult:t,sendLost:n,endTurnMethod:a})},getHandlers:()=>({incomingAttackHandler:p.manager.incomingAttackHandler,incomingResultHandler:p.manager.incomingResultHandler}),startTurn:()=>p.manager.startTurn(),endCombat:()=>{p.manager&&(p.manager.reset(),p.manager=null)}};return{id:o,name:c,view:d,provideTrackingFleet:d.provideTrackingFleet,placement:{start:u.startPlacement,end:u.endPlacement},combat:{init:p.loadManager,start:p.startCombat,startTurn:p.startTurn,getHandlers:p.getHandlers,end:()=>p.endCombat},reset:()=>{u.endPlacement(),p.endCombat(),d.reset()}}};var En=n(440),Tn={};Tn.styleTagTransform=p(),Tn.setAttributes=o(),Tn.insert=l().bind(null,"head"),Tn.domAPI=r(),Tn.insertStyleElement=d(),t()(En.Z,Tn),En.Z&&En.Z.locals&&En.Z.locals;const An="ai-board",bn=document.querySelector(".game-container"),fn=(e,t)=>{const n=ge(ie,{attributes:{class:An}}),a=ge(ie,{attributes:{class:An}}),r=ge(ie,{attributes:{class:"ai-vs-ai-display"}});n.append(e.board.provideTrackingGrid(),t.board.provideTrackingFleet()),a.append(t.board.provideTrackingGrid(),e.board.provideTrackingFleet()),r.append(n,a),bn.append(r)},yn=e=>{const t=Lt(),{subscribe:n,unsubscribe:a,publish:r}=t,{global:s,base:l,scopes:i}=e;let o=[];const c=((e={},t={},n=[])=>{const a=[],r={global:t,base:{},scoped:{},baseTypes:{}},s=e=>{r.base=e,Object.entries(r.base).forEach((([e,t])=>{if("object"==typeof t){const t=e.toUpperCase().replace(/ /g,"_");r.baseTypes[t]=e}})),o()},l=(e,t)=>`${e}@${t}`,i=(e,t,n={})=>(Object.entries(t).forEach((([t,a])=>{"object"==typeof a?(n[t]={},i(e,a,n[t])):n[t]=l(e,a)})),n),o=()=>a.forEach((e=>r.scoped[e]=i(e,r.base)));return Object.values(e).length>0&&s(e),n.length>0&&(n.forEach((e=>a.push(e))),o()),{createKey:l,addScope:e=>{a.push(e),o()},removeScope:e=>{const t=a.findIndex((t=>t===e));-1!==t&&(a.splice(t,1),delete r.scoped[e])},buildScopedEvents:o,setBaseEvents:s,setGlobalEvents:e=>r.global=e,getGlobalEvents:()=>r.global,getBaseEvents:()=>r.base,getScopedEvents:()=>r.scoped,getBaseTypes:()=>r.baseTypes,reset:()=>{r.global={},r.base={},r.scoped={},r.baseTypes={},a.length=0}}})(l,s,i),d=()=>{o.forEach((({event:e,callback:t})=>a(e,t))),o=[]};return{on:(e,t)=>{n(e,t),o.push({event:e,callback:t})},off:(e,t)=>{a(e,t),o=o.filter((n=>!(n.event===e&&n.callback===t)))},offAll:d,emit:r,events:c,reset:()=>{d(),c.reset(),t.reset()}}},Cn=e=>{const{p1Settings:t,p2Settings:n,boardSettings:a}=e,{p1:r,p2:s,gameMode:l}=(({p1Settings:e,p2Settings:t,boardSettings:n})=>{return{p1:tn({playerSettings:e,boardSettings:n,fleetData:L}),p2:tn({playerSettings:t,boardSettings:n,fleetData:L}),gameMode:(a=e.type,r=t.type,a===C&&r===C?B:a===v&&r===v?"AvA":"HvA")};var a,r})({p1Settings:t,p2Settings:n,boardSettings:a}),[i,o]=[r.model.id,s.model.id],{p1BoardController:c,p2BoardController:d}=((e,t,n)=>{bn.textContent="";const a={[v]:e=>e.controllers.board,[C]:e=>Sn({playerId:e.model.id,playerName:e.model.getName(),displayContainer:bn,gameMode:n,controllers:e.controllers})},r={HvA:(e,t)=>{e.type===C?e.board.view.init(t.board.provideTrackingFleet(),t.board.provideTrackingGrid()):t.type===C&&t.board.view.init(e.board.provideTrackingFleet(),e.board.provideTrackingGrid())},AvA:fn,[B]:(e,t)=>{e.board.view.init(t.board.provideTrackingFleet()),t.board.view.init(e.board.provideTrackingFleet())}},s=a[e.model.getType()](e),l=a[t.model.getType()](t);return r[n]({type:e.model.getType(),board:s},{type:t.model.getType(),board:l}),{p1BoardController:s,p2BoardController:l}})(r,s,l),u=(e=>{const{ids:t,controllers:n,controllerTypes:a,names:r,gameMode:s}=e,l=()=>{Object.values(n).forEach((e=>e.reset()))};return{ids:t,gameMode:s,controllerTypes:a,getPlayerName:e=>r[e],getControllersOfType:e=>Object.fromEntries(Object.entries(n).map((([t,n])=>[t,n[e]]))),getOpponentName:e=>{const n=t.find((t=>e!==t));if(n)return r[n]},resetControllers:l,reset:()=>{l(),t.forEach((e=>{delete n[e],delete r[e]}))}}})({ids:[i,o],names:{[i]:r.model.getName(),[o]:s.model.getName()},controllers:{[i]:c,[o]:d},controllerTypes:{PLACEMENT:"placement",COMBAT:"combat"},gameMode:l}),p={getScoped:(e,t=null)=>{let n=g.events.getScopedEvents()[e];return t&&(n=n[t]),n},getGlobal:(g=yn({global:{START_OVER:"startStateOver",PLACEMENT_OVER:"placementStateOver",PROGRESS_OVER:"progressStateOver"},base:{turn:{START_TURN:"startTurn",END_TURN:"endTurn"},placement:{FINALIZE_PLACEMENT:"finalizePlacement"},combat:{SEND_ATTACK:"sendAttack",SEND_RESULT:"sendIncomingAttackResult",SEND_SHIP_SUNK:"shipSunk"}},scopes:[i,o]})).events.getGlobalEvents,getBaseTypes:g.events.getBaseTypes,getEventMethods:()=>({on:g.on,off:g.off,emit:g.emit}),reset:g.reset};var g;const m=(({p1Id:e,p2Id:t,eventManager:n})=>{const{emit:a,on:r,off:s}=n.getEventMethods(),{getScoped:l,getBaseTypes:i}=n,o=i().TURN,{START_TURN:c,END_TURN:d}=l(e,o),{START_TURN:u,END_TURN:p}=l(t,o);return(({emit:e,on:t,off:n,events:a,p1Id:r,p2Id:s})=>{const{p1StartTurn:l,p1EndTurn:i,p2StartTurn:o,p2EndTurn:c}=a,d={[r]:{START:l,END:i},[s]:{START:o,END:c}},u={current:r,waiting:s},p=()=>e(d[u.current].START),g=()=>{[u.current,u.waiting]=[u.waiting,u.current],p()},m=(()=>{let e=!1;return{enable:()=>{e||(t(d[r].END,g),t(d[s].END,g),e=!0)},disable:()=>{e||(n(d[r].END,g),n(d[s].END,g),e=!1)}}})(),h=e=>{let a=null;const r=()=>d[e].START;return{set:e=>{a&&n(r(),a),t(r(),e),a=e},remove:()=>{a&&(n(r(),a),a=null)}}},S={[r]:h(r),[s]:h(s)},E=e=>{let a=null;const r=()=>d[e].END;return{set:e=>{a&&n(r(),a),t(r(),e),a=e},remove:()=>{a&&(n(r(),a),a=null)}}},T={[r]:E(r),[s]:E(s)};return{autoAlternate:{enable:m.enable,disable:m.disable},currentPlayer:{getId:()=>u.current,startTurn:p,endTurn:()=>e(d[u.current].END)},allPlayers:{getAllPlayerEndTurnMethods:()=>Object.fromEntries(Object.entries(d).map((([t,n])=>[t,()=>e(n.END)]))),onTurnStartManagers:S,onTurnEndManagers:T},alternate:g,reset:()=>{u.current=r,u.waiting=s,m.disable(),Object.values(S).forEach((e=>e.remove())),Object.values(S).forEach((e=>e.remove()))}}})({emit:a,on:r,off:s,events:{p1StartTurn:c,p1EndTurn:d,p2StartTurn:u,p2EndTurn:p},p1Id:e,p2Id:t})})({p1Id:i,p2Id:o,eventManager:p});return{playerManager:u,eventManager:p,turnManager:m}},vn="label",Ln={HIDE:"hide",HEADER_WRAPPER:"settings-dialog-header-wrapper",DIALOG_TITLE:"dialog-title",DIALOG:"settings-dialog dialog"},In={DIALOG_TITLE:"Settings"},Pn="player-information-container",Rn="player-information-input-container",kn="player-one",Mn="human",On="Player One",wn="player-one-settings-title",xn="player-two",Nn="ai",Hn="Player Two",Dn="player-two-settings-title",_n=e=>({ELEMENT:le,CLASS:`${e}-name-text-input`,ATTRIBUTES:{TYPE:"text",PLACEHOLDER:"Username",ID:`${e}-name`}}),Bn={ELEMENT:"select",OPTION_ELEMENT:"option",INPUT_FIELD_CLASS:e=>`${e}-select-input`},Un={ELEMENT:le,ATTRIBUTES:{TYPE:"number",MIN:0,DEFAULT_VALUE:250},CLASSES:{WRAPPER:"attack-delay-input-wrapper",LABEL:"attack-delay-label",ATTACK_DELAY_INPUT:"attack-delay-input"},TEXTS:{ATTACK_DELAY:"Attack Delay (ms)"}},$n={ELEMENT:le,ATTRIBUTES:{TYPE:"number",MAX:26,MIN:10,ROWS_ID:"rows",COLS_ID:"cols"},CLASSES:{COLS_INPUT:"cols-input",ROWS_INPUT:"rows-input",COLS_INPUT_WRAPPER:"cols-input-wrapper",COLS_INPUT_LABEL:"cols-input-label",ROWS_INPUT_WRAPPER:"rows-input-wrapper",ROWS_INPUT_LABEL:"rows-input-label"},TEXTS:{ROWS:"Rows",COLS:"Cols"}},Gn={DIFFICULTY:{ATTRIBUTES:{ID:e=>`${e}-difficulty`},OPTIONS:[{id:"easy",text:"Easy",value:"0"},{id:"medium",text:"Medium",value:"1"},{id:"hard",text:"Hard",value:"2"}]},PLAYER_TYPE:{TYPES:{HUMAN:"human",COMPUTER:"ai"},TEXTS:{HUMAN:"Human",COMPUTER:"Computer"},PLAYER_TYPE_CLASS:e=>`${e}-type`},LETTER_AXIS:{CLASSES:{WRAPPER:"letter-axis-input-wrapper",LABEL:"letter-axis-input-label"},ATTRIBUTES:{ID:"letter-axis"},TEXTS:{LABEL:"Letter Axis",ROW:"Row",COL:"Column"},OPTIONS:[{id:"row",text:"Row",value:"row"},{id:"col",text:"Column",value:"col"}]}},Fn="board-settings-container",qn="board-settings-inputs-container",Yn="board-settings-title",Wn="Board",zn="Submit",Zn="settings-submit-button",Vn={TEXT:"*Submitting will start a new game",CLASS:"settings-submit-disclaimer hide"},jn="Cancel",Xn="settings-cancel-button",Kn="Instructions",Qn="settings-instructions-button",Jn=(e,t)=>ue(vn,{text:e,attributes:t}),ea=({id:e,options:t,hide:n=!1,label:a=null})=>{const r=t.map((e=>(({id:e,value:t,text:n,isSelected:a=!1})=>ue(Bn.OPTION_ELEMENT,{id:e??t,text:n,attributes:{value:t,...a&&{selected:""}}}))(e))),s=[...r];return a&&s.push(a),ue(Bn.ELEMENT,{attributes:{id:e,class:`${Bn.INPUT_FIELD_CLASS(e)} ${n?Ln.HIDE:""}`},children:s})},ta=(e,t=!1)=>ea({id:Gn.DIFFICULTY.ATTRIBUTES.ID(e),options:Gn.DIFFICULTY.OPTIONS,hide:t}),na=(e,t=!1)=>{const n=_n(e);return ue(n.ELEMENT,{attributes:{type:n.ATTRIBUTES.TYPE,placeholder:n.ATTRIBUTES.PLACEHOLDER,id:n.ATTRIBUTES.ID,class:`${n.CLASS} ${t?Ln.HIDE:""}`}})},aa=(e,t)=>{const n=[],a={value:Gn.PLAYER_TYPE.TYPES.HUMAN,text:Gn.PLAYER_TYPE.TEXTS.HUMAN,isSelected:t===Gn.PLAYER_TYPE.TYPES.HUMAN},r={value:Gn.PLAYER_TYPE.TYPES.COMPUTER,text:Gn.PLAYER_TYPE.TEXTS.COMPUTER,isSelected:t===Gn.PLAYER_TYPE.TYPES.COMPUTER};return n.push(a),n.push(r),ea({id:Gn.PLAYER_TYPE.PLAYER_TYPE_CLASS(e),options:n})},ra=({id:e,classAttr:t,wrapperClass:n,labelText:a,labelClass:r})=>me(n,[ue($n.ELEMENT,{attributes:{type:$n.ATTRIBUTES.TYPE,min:$n.ATTRIBUTES.MIN,max:$n.ATTRIBUTES.MAX,value:$n.ATTRIBUTES.MIN,id:e,class:t}}),Jn(a,{for:e,class:r})]),sa=e=>me(`${Un.CLASSES.WRAPPER}`,[ue(Un.ELEMENT,{attributes:{type:Un.ATTRIBUTES.TYPE,min:Un.ATTRIBUTES.MIN,value:Un.ATTRIBUTES.DEFAULT_VALUE,id:e,class:Un.CLASSES.ATTACK_DELAY_INPUT}}),Jn(Un.TEXTS.ATTACK_DELAY,{for:e,class:Un.CLASSES.LABEL})]),la="p1DynamicDifficulty",ia="p2DynamicDifficulty";var oa=n(61),ca={};ca.styleTagTransform=p(),ca.setAttributes=o(),ca.insert=l().bind(null,"head"),ca.domAPI=r(),ca.insertStyleElement=d(),t()(oa.Z,ca),oa.Z&&oa.Z.locals&&oa.Z.locals;const da=()=>{let e=null;const t=(()=>{const e={settings:null},t={settings:null},n={settings:null};return{getSettings:()=>({p1Settings:e.settings,p2Settings:t.settings,boardSettings:n.settings}),updateSettings:({p1Settings:a,p2Settings:r,boardSettings:s})=>{e.settings=a,t.settings=r,n.settings=s}}})(),n=(()=>{const e=(()=>{const e=me(Ln.HEADER_WRAPPER,[he(In.DIALOG_TITLE,Ln.DIALOG_TITLE),Se(Kn,`${Qn} ${Rt}`)]),t=me(Rn,[me(Pn,[he(On,wn),aa(kn,Mn),na(kn),ta(kn,!0),sa(kn)]),me(Pn,[he(Hn,Dn),aa(xn,Nn),na(xn,!0),ta(xn,!1),sa(xn)])]),n=me(Fn,[he(Wn,Yn),me(qn,[ra({id:$n.ATTRIBUTES.ROWS_ID,classAttr:$n.CLASSES.ROWS_INPUT,wrapperClass:$n.CLASSES.ROWS_INPUT_WRAPPER,labelText:$n.TEXTS.ROWS,labelClass:$n.CLASSES.ROWS_INPUT_LABEL}),ra({id:$n.ATTRIBUTES.COLS_ID,classAttr:$n.CLASSES.COLS_INPUT,wrapperClass:$n.CLASSES.COLS_INPUT_WRAPPER,labelText:$n.TEXTS.COLS,labelClass:$n.CLASSES.COLS_INPUT_LABEL}),me(Gn.LETTER_AXIS.CLASSES.WRAPPER,[ea({id:Gn.LETTER_AXIS.ATTRIBUTES.ID,options:Gn.LETTER_AXIS.OPTIONS,label:Jn(Gn.LETTER_AXIS.TEXTS.LABEL,{for:Gn.LETTER_AXIS.ATTRIBUTES.ID,class:Gn.LETTER_AXIS.CLASSES.LABEL})}),Jn(Gn.LETTER_AXIS.TEXTS.LABEL,{for:Gn.LETTER_AXIS.ATTRIBUTES.ID,class:Gn.LETTER_AXIS.CLASSES.LABEL})])])]),a=me("dialog-buttons-container",[Se(zn,`${Zn} ${Rt}`),he(Vn.TEXT,Vn.CLASS),Se(jn,`${Xn} ${Rt} ${Ln.HIDE}`)]),r=ue(re,{attributes:{class:Ln.DIALOG},children:[e,t,n,a]});return pe(r)})(),{listenerManager:t,setOnSubmit:n,setOpenInstructions:a}=((e,t=null,n=null)=>{if(!(e&&e instanceof HTMLElement))throw new Error(`Invalid Element: ${e}`);const a=wt(),{p1TypeSelect:r,p1UsernameInput:s,p2TypeSelect:l,p2UsernameInput:i,p2DifficultySelect:o,p1DifficultySelect:c,p1AttackDelayInput:d,p2AttackDelayInput:u,rowsInput:p,colsInput:g,letterAxisInput:m,instructionsButton:h,submitButton:S,cancelButton:E}=(e=>{const t=e.querySelector(`#${Gn.PLAYER_TYPE.PLAYER_TYPE_CLASS(kn)}`),n=e.querySelector(`.${_n(kn).CLASS}`),a=e.querySelector(`#${Gn.DIFFICULTY.ATTRIBUTES.ID(kn)}`),r=e.querySelector(`.${Un.CLASSES.ATTACK_DELAY_INPUT}#${kn}`);return{p1TypeSelect:t,p1UsernameInput:n,p2TypeSelect:e.querySelector(`#${Gn.PLAYER_TYPE.PLAYER_TYPE_CLASS(xn)}`),p2UsernameInput:e.querySelector(`.${_n(xn).CLASS}`),p2DifficultySelect:e.querySelector(`#${Gn.DIFFICULTY.ATTRIBUTES.ID(xn)}`),p1DifficultySelect:a,p1AttackDelayInput:r,p2AttackDelayInput:e.querySelector(`.${Un.CLASSES.ATTACK_DELAY_INPUT}#${xn}`),rowsInput:e.querySelector(`.${$n.CLASSES.ROWS_INPUT}`),colsInput:e.querySelector(`.${$n.CLASSES.COLS_INPUT}`),letterAxisInput:e.querySelector(`#${Gn.LETTER_AXIS.ATTRIBUTES.ID}`),instructionsButton:e.querySelector(`.${Qn}`),submitButton:e.querySelector(`.${Zn}`),cancelButton:e.querySelector(`.${Xn}`)}})(e),T={onsubmit:t,openInstructions:n},A=e=>{const t=e.value,n=e.classList;t===Gn.DIFFICULTY.OPTIONS[0].value?(n.add(Gn.DIFFICULTY.OPTIONS[0].id),n.remove(Gn.DIFFICULTY.OPTIONS[1].id),n.remove(Gn.DIFFICULTY.OPTIONS[2].id)):t===Gn.DIFFICULTY.OPTIONS[1].value?(n.remove(Gn.DIFFICULTY.OPTIONS[0].id),n.add(Gn.DIFFICULTY.OPTIONS[1].id),n.remove(Gn.DIFFICULTY.OPTIONS[2].id)):(n.remove(Gn.DIFFICULTY.OPTIONS[0].id),n.remove(Gn.DIFFICULTY.OPTIONS[1].id),n.add(Gn.DIFFICULTY.OPTIONS[2].id))},b=()=>A(c),C=()=>A(o),v=({typeSelect:e,usernameInput:t,difficultySelect:n,attackDelayInput:r,dynamicDifficultyKey:s})=>{e.value===Gn.PLAYER_TYPE.TYPES.HUMAN?(t.classList.remove(Ln.HIDE),r.parentElement.style.display="none",n.classList.add(Ln.HIDE),a.disableListener(s)):(t.classList.add(Ln.HIDE),n.classList.remove(Ln.HIDE),r.parentElement.removeAttribute("style"),a.enableListener(s))},L=({typeSelect:e,difficultySelect:t,usernameInput:n,attackDelayInput:a})=>{const r=e.value;return r===Gn.PLAYER_TYPE.TYPES.COMPUTER?{type:r,difficulty:t.value,attackDelay:a.value}:{type:r,username:n.value}},I=()=>{a.disableAllListeners(),e.close(),e.remove()};return a.addController({element:h,event:we,callback:()=>{T.openInstructions&&T.openInstructions()},key:"openInstructions"}),a.addController({element:e,event:Ne,callback:e=>{e.key===_e&&e.preventDefault()},key:"preventEscape"}),a.addController({element:c,event:Oe,callback:b,key:la}),a.addController({element:o,event:Oe,callback:C,key:ia}),a.addController({element:p,event:Oe,callback:()=>{p.value>26&&(p.value=26)},key:"rowRestriction"}),a.addController({element:g,event:Oe,callback:()=>{g.value>26&&(g.value=26)},key:"colRestriction"}),a.addController({element:r,event:Oe,callback:()=>v({typeSelect:r,usernameInput:s,difficultySelect:c,attackDelayInput:d,key:la}),key:"p1UpdateOnPlayerTypeChange"}),a.addController({element:l,event:Oe,callback:()=>v({typeSelect:l,usernameInput:i,difficultySelect:o,attackDelayInput:u,key:ia}),key:"p2UpdateOnPlayerTypeChange"}),a.addController({element:S,event:we,callback:()=>{if(T.onsubmit){const e={p1Settings:{...L({typeSelect:r,difficultySelect:c,usernameInput:s,attackDelayInput:d}),id:f},p2Settings:{...L({typeSelect:l,difficultySelect:o,usernameInput:i,attackDelayInput:u}),id:y},boardSettings:{numberOfRows:p.value,numberOfCols:g.value,letterAxis:m.value}};T.onsubmit(e)}I()},key:"submit"}),a.addController({element:E,event:we,callback:I,key:"cancel"}),b(),C(),d.parentElement.style.display="none",{listenerManager:a,setOnSubmit:e=>T.onsubmit=e,setOpenInstructions:e=>T.openInstructions=e}})(e),r=e.querySelector(".settings-submit-disclaimer"),s=e.querySelector(".settings-cancel-button");let l=document.querySelector("body");const i=e=>{if(!(e&&e instanceof HTMLElement))throw new Error(`Invalid Container: ${e}`);l=e};return{setContainer:i,display:(n=null)=>{if(n&&i(n),!l)throw new Error("Cannot display dialog without a container.");l.append(e),t.enableAllListeners(),e.showModal()},showDisclaimer:()=>r.classList.remove("hide"),showCloseButton:()=>s.classList.remove("hide"),setOnSubmit:n,setOpenInstructions:a}})();return n.setOnSubmit((a=>{const{p1Settings:r,p2Settings:s,boardSettings:l}=a;t.updateSettings({p1Settings:r,p2Settings:s,boardSettings:l}),n.showDisclaimer(),n.showCloseButton(),e&&e(a)})),{getCurrentSettings:t.getSettings,setContainer:n.setContainer,display:n.display,setOnSubmit:t=>e=t,setOpenInstructions:n.setOpenInstructions}},ua="dialog",pa="dialog-header-primary",ga="green-underline",ma="game-over-dialog",ha="game-over-dialog-header",Sa="game-over-dialog-header-message-wrapper",Ea="game-winner-name",Ta="winner-message",Aa="game-over-button-container",ba="play-again-button",fa="close-this-dialog-button",ya="game-over-settings-button",Ca="Play Again",va="Close",La="Open Settings";var Ia=n(960),Pa={};Pa.styleTagTransform=p(),Pa.setAttributes=o(),Pa.insert=l().bind(null,"head"),Pa.domAPI=r(),Pa.insertStyleElement=d(),t()(Ia.Z,Pa),Ia.Z&&Ia.Z.locals&&Ia.Z.locals;const Ra=e=>`${e}-instruction-button`,ka="instructions-dialog dialog",Ma={TEXT:"INSTRUCTIONS",CLASS:"dialog-title",WRAPPER_CLASS:"instructions-header-wrapper"},Oa={TEXT:"CLOSE",CLASS:"instructions-close-button"},wa="instructions-content-container",xa={CONTAINER_CLASS:"instructions-button-container",PLACEMENT:{TEXT:"Placement",CLASS:Ra("placement")},COMBAT:{TEXT:"Combat",CLASS:Ra("combat")},SETTINGS:{TEXT:"Settings",CLASS:Ra("settings")}},Na={primary:{containerClass:"instructions-content-container",headerClass:`${pa} ${ga}`},sections:{containerClass:"instructions-section-container",headerClass:`dialog-header-secondary ${ga}`,instructionListItemClass:"instruction-list-item",instructionTextClass:"color-white"}},Ha={instructionName:"placementInstructions",instructionHeaderText:"Placement Instructions",sections:[{sectionName:"selectAndPlace",markerType:"numeric",sectionHeaderText:"Selecting and Placing Ships",instructions:['To select a ship, click on it in the "Your Fleet" list using the Left-Mouse Button.','Place the selected ship on your "Home Territory" grid by clicking the Left-Mouse Button (or tap on mobile) at the desired grid location.']},{sectionName:"rotate",markerType:"bullet",sectionHeaderText:"Rotating Ships",instructions:['To rotate a ship before placing it you can: click the "Rotate Ship" Button, press the Middle-Mouse Button, Space-Bar, or the R Key']},{sectionName:"reposition",markerType:"bullet",sectionHeaderText:"Repositioning Ships",instructions:['To reposition a ship that\'s already placed, click on it again in the "Your Fleet" list using the Left-Mouse Button and then place it in a new location on the grid.']},{sectionName:"finalize",markerType:"numeric",sectionHeaderText:"Finalizing Placement",instructions:['Once you have positioned all your ships, the "Submit Placements" button directly below the "Your Fleet" list will become active.','Click the "Submit Placements" button to confirm your ship placements and proceed.']}]},Da={instructionName:"combatInstructions",instructionHeaderText:"Combat Instructions",sections:[{sectionName:"gridAndCells",markerType:"bullet",sectionHeaderText:"Grids and Cells",instructions:["As you know from the placement stage, the Home Territory grid is where you place your ships. Your placed ships are displayed as gray cells containing the first letter of the placed ship's name.","The Enemy Territory grid is where you send and track attacks."]},{sectionName:"attacking",markerType:"bullet",sectionHeaderText:"Attacking",instructions:['To send an attack on your turn, click on an unexplored cell in the "Enemy Territory" grid.',"A light gray cell indicates a missed attack and a red cell indicates a hit."]},{sectionName:"turnRotation",markerType:"bullet",sectionHeaderText:"Turns",instructions:["If you're playing vs the computer, then after you send an attack it will respond immediately and you can continue until the game ends.",'If you\'re playing vs another human, after you send an attack you will be unable to send another attack. Instead you can click the "End Turn" button which will hide the screen to allow the next player to continue.']},{sectionName:"gameEnd",markerType:"bullet",sectionHeaderText:"Game Over",instructions:["When all of a player's ships have been sunk, the game ends.",'The winner will be displayed and a new game can be started directly by pressing the "Restart Game" button. Or you can exit the dialog and adjust the settings to start a new game.']}]},_a={instructionName:"settingsInstructions",instructionHeaderText:"Settings Instructions",sections:[{sectionName:"playerSettings",markerType:"bullet",sectionHeaderText:"Player",instructions:["Type: Whether the player is a human or a computer AI.","Username: Human type players can enter their username. Those who do not enter a username will be labeled accordingly.","Difficulty: Computer type players have a difficulty option which dictates the level of intelligence and strategic capabilities. Easy -> Attacks randomly every turn with zero strategy. Medium -> Will follow up on hits until a ship is sunk. Hard -> Good luck.","Attack Delay (ms): The amount of time in milliseconds the AI will wait before sending an attack."]},{sectionName:"boardSettings",markerType:"bullet",sectionHeaderText:"Board",instructions:["Rows and Cols: The number of rows and/or columns to make the grid (Minimum = 10, Maximum = 26).",'Letter Axis: The axis to use letter labels. Respectively, coordinates are displayed like so, Row -> "A5", Column -> "5A".']},{sectionName:"buttons",markerType:"bullet",sectionHeaderText:"Buttons",instructions:["Submit: Updates the game settings and starts a new  game.","Instructions: Opens the these instructions.","Cancel: Closes the dialog without making any changes."]}]},Ba={CLOSE:"close",PLACEMENT:"placement",COMBAT:"combat",SETTINGS:"settings"},Ua=e=>{const t=wt(),n=(()=>{const e=(()=>{const e=new Map,t=e=>{const{sectionHeaderText:t,instructions:n,markerType:a}=e,r=he(t,Na.sections.headerClass),s=n.map(((e,t)=>((e,t)=>{const n=he(e,Na.sections.instructionListItemClass),a=Ee(t,Na.sections.instructionTextClass);return n.children=[a],n})("numeric"===a?(e=>`${e+1}.`)(t):"•",e)));return me(Na.sections.containerClass,[r,...s])};return{loadInstructionsConfig:t=>{const{instructionName:n,instructionHeaderText:a,sections:r}=t;((t,n,a)=>{e.set(t,{instructionHeaderText:n,sections:a})})(n,a,r)},buildInstruction:n=>{const a=e.get(n);if(!a)return console.error("Instruction name not found:",n),null;const{instructionHeaderText:r,sections:s}=a,l=s.map(t);return me(Na.primary.containerClass,[he(r,Na.primary.headerClass),...l])}}})();return e.loadInstructionsConfig(Ha),e.loadInstructionsConfig(Da),e.loadInstructionsConfig(_a),{placement:pe(e.buildInstruction("placementInstructions")),combat:pe(e.buildInstruction("combatInstructions")),settings:pe(e.buildInstruction("settingsInstructions"))}})(),a=(e=>({close:e.querySelector(`.${Oa.CLASS}`),placement:e.querySelector(`.${xa.PLACEMENT.CLASS}`),combat:e.querySelector(`.${xa.COMBAT.CLASS}`),settings:e.querySelector(`.${xa.SETTINGS.CLASS}`)}))(e),r=e.querySelector(`.${wa}`),s=e=>{let t=null;e.target.classList.contains(xa.PLACEMENT.CLASS)?t="placement":e.target.classList.contains(xa.COMBAT.CLASS)?t="combat":e.target.classList.contains(xa.SETTINGS.CLASS)&&(t="settings"),Object.values(a).forEach((e=>e.classList.remove("active"))),a[t]?.classList.add("active"),r.textContent="";const s=n[t];s&&r.append(s)};return t.addController({element:a.close,event:we,callback:()=>{t.disableAllListeners(),e.close(),e.remove()},key:Ba.CLOSE}),[{btn:a.placement,key:Ba.PLACEMENT},{btn:a.combat,key:Ba.COMBAT},{btn:a.settings,key:Ba.SETTINGS}].forEach((({btn:e,key:n})=>{t.addController({element:e,event:we,callback:s,key:n})})),t},$a=(()=>{const e=(()=>{const e=(()=>{const e=me(Ma.WRAPPER_CLASS,[he(Ma.TEXT,Ma.CLASS),Se(Oa.TEXT,`${Oa.CLASS} ${Rt}`)]),t=me(xa.CONTAINER_CLASS,[Se(xa.PLACEMENT.TEXT,`${xa.PLACEMENT.CLASS} ${Rt}`),Se(xa.COMBAT.TEXT,`${xa.COMBAT.CLASS} ${Rt}`),Se(xa.SETTINGS.TEXT,`${xa.SETTINGS.CLASS} ${Rt}`)]),n=ue(ie,{attributes:{class:wa}}),a=ue(re,{attributes:{class:ka},children:[e,t,n]});return pe(a)})(),t=Ua(e);let n=document.querySelector("body");const a=e=>{if(!(e&&e instanceof HTMLElement))throw new Error(`Invalid Container: ${e}`);n=e};return{setContainer:a,display:(r=null)=>{if(r&&a(r),!n)throw new Error("Cannot display dialog without a container.");n.append(e),t.enableAllListeners(),e.showModal()}}})(),t=da(),n=(()=>{const{dialogElement:e,playAgainBtn:t,closeButton:n,openSettingsBtn:a,winnerNameElement:r,winnerMessageElement:s}=(()=>{const e=ue(re,{attributes:{class:`${ma} ${ua}`},children:[me(ha,[me(Sa,[Ee("",`${Ea} white-underline`),Ee("",Ta)]),Se(va,`${fa} ${Rt}`)]),me(Aa,[Se(Ca,`${ba} ${Rt}`),Se(La,`${ya} ${Rt}`)])]}),t=pe(e),n=t.querySelector(`.${fa}`),a=t.querySelector(`.${ba}`),r=t.querySelector(`.${ya}`),s=t.querySelector(`.${Ea}`),l=t.querySelector(`.${Ta}`);return{dialogElement:t,closeButton:n,playAgainBtn:a,openSettingsBtn:r,winnerNameElement:s,winnerMessageElement:l}})(),l=wt();let i=document.querySelector("body"),o="",c=" Wins!";const d={playAgain:null,openSettings:null},u=e=>{if(!(e&&e instanceof HTMLElement))throw new Error(`Invalid Container: ${e}`);i=e},p=()=>{l.disableAllListeners(),e.close()};return l.addController({element:n,event:we,callback:p,key:"closeDialog",enable:!0}),l.addController({element:t,event:we,callback:()=>{d.playAgain&&d.playAgain(),p()},key:"playAgain",enable:!0}),l.addController({element:a,event:we,callback:()=>{d.openSettings&&d.openSettings(),p()},key:"openSettings",enable:!0}),{setWinnerName:e=>o=e,setWinnerMessage:e=>c=e,setContainer:u,setOnPlayAgain:e=>d.playAgain=e,setOpenSettings:e=>d.openSettings=e,display:(t=o,n=null)=>{if(n&&u(n),!i)throw new Error("Cannot display dialog without a container.");i.append(e),(e=>{r.textContent=e,s.textContent=c})(t),l.enableAllListeners(),e.showModal()}}})();t.setOpenInstructions(e.display),n.setOpenSettings(t.display);const a={dialog:null,get:()=>(a.dialog||(a.dialog=(()=>{const{dialogElement:e,proceedButtonElement:t,playerNameElement:n}=(()=>{const e=(()=>{const e=he("",`${pa}`),t=Ee("",`next-player-name ${ga}`);return e.children=[t],e})(),t=Se("Proceed",`proceed-to-next-player-button ${Rt}`),n=ue(re,{attributes:{class:`alternate-player-dialog ${ua}`},children:[e,t]}),a=pe(n),r=a.querySelector(".next-player-name"),s=a.querySelector(".proceed-to-next-player-button");return{dialogElement:a,playerNameElement:r,proceedButtonElement:s}})();let a=null;const r=()=>{t.removeEventListener(we,e.showModal),e.close(),e.remove()};let s=document.querySelector("body");const l=e=>{if(!(e&&e instanceof HTMLElement))throw new Error(`Invalid Container: ${e}`);s=e};return{setContainer:l,setPlayerName:e=>a=e,display:(i=a,o=null)=>{if(o&&l(o),!s)throw new Error("Cannot display dialog without a container.");s.append(e),n.textContent=`${i}'s Turn`,t.addEventListener(we,r),e.showModal()}}})()),a.dialog),remove:()=>a.dialog=null};return document.querySelector(".settings-button").addEventListener("click",(e=>t.display())),document.querySelector(".instructions-button").addEventListener("click",(t=>e.display())),{settings:t,gameOver:n,alternatePlayers:{getDialog:a.get,removeDialog:a.remove}}})();(()=>{const{settings:e,gameOver:t,alternatePlayers:n}=$a,{getCurrentSettings:a}=e,r={turn:null,player:null,event:{manager:null,methods:null,getters:{},setManager:e=>{r.event.manager&&r.event.manager.reset(),r.event.manager=e,r.event.methods=e.getEventMethods(),r.event.getters.getGlobal=e.getGlobal,r.event.getters.getScoped=e.getScoped,r.event.getters.getBaseTypes=e.getBaseTypes}},reset:()=>{r.turn?.reset(),r.player?.reset(),r.event.manager?.reset(),r.turn=null,r.player=null,r.event.manager=null,r.event.methods=null,r.event.getters={}}},{startGame:s,onEnter:l,onExit:i,transitionTo:o}=((e=[])=>{const t={current:null},n=e=>t[e]={onEnter:[],onExit:[]},a=e=>{t.current=e,l()},r=e=>e.forEach((e=>e())),s=()=>r(t[t.current][b]),l=()=>r(t[t.current][A]);return e.length>0&&e.forEach((e=>n(e))),{addState:n,onEnter:(e,n)=>t[e][A].push(n),onExit:(e,n)=>t[e][b].push(n),startGame:e=>{t.current&&s(),a(e)},transitionTo:e=>{s(),a(e)},exitCurrent:()=>{s(),t.current=null}}})([I,P,R,k]),c=(()=>{const e=()=>{r.reset(),s(I)},c=()=>{const e=Cn(a()),{playerManager:t,eventManager:s,turnManager:l}=e;r.player=t,r.turn=l,r.event.setManager(s),l.autoAlternate.enable();const{gameMode:i,ids:c,getOpponentName:d}=r.player;if(i===B){const e=l.allPlayers.onTurnEndManagers,t=n.getDialog();c.forEach((n=>{const a=d(n);e[n].set((()=>t.display(a)))}))}o(P)},d=()=>{},u=(()=>{let e=null;const t=()=>o(R);return{enter:()=>{e&&e.reset();const{endTurn:n,getId:a}=r.turn.currentPlayer,{ids:s,getControllersOfType:l,controllerTypes:i}=r.player,{methods:o,getters:c}=r.event,d=l(i.PLACEMENT);e=(({endCurrentPlayerTurn:e,getCurrentPlayerId:t,playerIds:n,placementControllers:a,eventMethods:r,eventGetters:s,transition:l})=>{const{on:i,off:o,emit:c}=r,{getBaseTypes:d,getScoped:u}=s;let p={};const g=({data:t})=>{p[t]=!0,e(),n.every((e=>p[e]))?l():m()},m=()=>{const e=t(),n=(e=>{const{FINALIZE_PLACEMENT:t}=u(e,d().PLACEMENT);return i(t,g),()=>{c(t,e),o(t,g)}})(e);a[e].start(n)};return{start:m,reset:()=>{p={},Object.values(a).forEach((e=>e.end()))}}})({endCurrentPlayerTurn:n,getCurrentPlayerId:a,playerIds:s,placementControllers:d,eventMethods:o,eventGetters:c,transition:t}),e.start()},exit:()=>{e.reset(),e=null}}})(),p=(()=>{let e=null,n=null;const a=({data:e})=>{const{id:n}=e,a=(e=>{const{ids:t,getPlayerName:n}=r.player,a=t.find((t=>t!==e));if(a)return n(a)})(n);t.setWinnerName(a),o(k)},s=(e=!1)=>{if(!r.event.methods)return;const{on:t,off:s}=r.event.methods;e?t(n,a):s(n,a)};return{enter:()=>{e&&e.reset();const{methods:t,getters:a}=r.event,{ids:l,getControllersOfType:i,controllerTypes:o,gameMode:c}=r.player,d=i(o.COMBAT),{getAllPlayerEndTurnMethods:u,onTurnStartManagers:p}=r.turn.allPlayers,g=u(),m=r.turn.currentPlayer.getId();n=a.getGlobal().PLAYER_LOST,e=(({eventMethods:e,eventGetters:t,combatControllers:n,playerIds:a,currentPlayerId:r,endTurnMethods:s,onTurnStartManagers:l,overEvent:i,gameMode:o})=>{let c=null;const{getScoped:d,getBaseTypes:u}=t;let p={};const g=e=>d(e,u().COMBAT),m=e=>n[e].getHandlers(),h=e=>({id:e,handlers:m(e),combatEvents:g(e)});return{start:()=>{const t=Object.entries(n);let m=e=>s[e];o===B&&(a.forEach((t=>p[t]=(({sendEndTurn:e,enableOn:t,disableOn:n,eventMethods:a})=>{const{on:r,off:s}=a,l=ge(de,{text:"End Turn",attributes:{class:`${Rt} end-turn-button`,disabled:""}}),i=()=>{l.disabled=!1,l.addEventListener(we,e)},o=()=>{l.disabled=!0,l.removeEventListener(we,e)};return r(t,i),r(n,o),{element:l,reset:()=>{s(t,i),s(n,o),o(),l.remove()}}})({sendEndTurn:s[t],enableOn:g(t).SEND_ATTACK,disableOn:d(t,u().TURN).START_TURN,eventMethods:e}))),m=e=>p[e].element),t.forEach((([e,t])=>{t.init(),l[e].set(t.startTurn)})),c||(()=>{if(c)return;const[t,n]=a;c=(({p1CombatData:e,p2CombatData:t,eventMethods:n,lostEvent:a})=>{const{id:r,handlers:s,combatEvents:l}=e,{id:i,handlers:o,combatEvents:c}=t,{on:d,off:u,emit:p}=n,g=(e,t)=>{const{SEND_ATTACK:n,SEND_RESULT:r}=e,{incomingAttackHandler:s,incomingResultHandler:l}=t;return d(n,s),d(r,l),{sendAttack:e=>p(n,e),sendResult:e=>p(r,e),sendLost:e=>p(a,e)}},m=(e,t)=>{const{SEND_ATTACK:n,SEND_RESULT:a}=e,{incomingAttackHandler:r,incomingResultHandler:s}=t;u(n,r),u(a,s)};return{[r]:g(l,o),[i]:g(c,s),reset:()=>{m(l,o),m(c,s)}}})({p1CombatData:h(t),p2CombatData:h(n),eventMethods:e,overEvent:i})})(),t.forEach((([e,t])=>{t.start({endTurnMethod:m(e),...c[e]})})),n[r].startTurn()},reset:()=>{c.reset(),c=null,Object.values(n).forEach((e=>e.end()));const e=Object.values(p);e.length>0&&e.forEach((e=>e.reset())),p={}}}})({eventMethods:t,eventGetters:a,combatControllers:d,playerIds:l,currentPlayerId:m,endTurnMethods:g,onTurnStartManagers:p,overEvent:n,gameMode:c}),e.start(),s(!0)},exit:()=>{e.reset(),e=null,s(!1)}}})(),g=()=>{t.setOnPlayAgain(e),t.display()};return l(I,c),i(I,d),l(P,u.enter),i(P,u.exit),l(R,p.enter),i(R,p.exit),l(k,g),{startGame:e}})();e.setOnSubmit(c.startGame),e.display()})()})()})();
//# sourceMappingURL=app.bundle.js.map